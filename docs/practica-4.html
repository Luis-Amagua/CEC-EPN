<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 5 Práctica 4 | Control Estadístico de la Calidad</title>
  <meta name="description" content="Prácticas de la asignatura de Control Estadistico de la Calidad." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 5 Práctica 4 | Control Estadístico de la Calidad" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Prácticas de la asignatura de Control Estadistico de la Calidad." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 5 Práctica 4 | Control Estadístico de la Calidad" />
  
  <meta name="twitter:description" content="Prácticas de la asignatura de Control Estadistico de la Calidad." />
  

<meta name="author" content="Miguel Flores Sánchez (miguel.flores@epn.edu.ec)" />


<meta name="date" content="2019-09-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="practica-3.html"/>
<link rel="next" href="practica-5.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Control Estadistico de la Calidad </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="part"><span><b>I Teoria</b></span></li>
<li class="chapter" data-level="1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html"><i class="fa fa-check"></i><b>1</b> Control Estadistico de la Calidad</a><ul>
<li class="chapter" data-level="1.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#cec-y-seis-sigma-alternativas-en-r"><i class="fa fa-check"></i><b>1.1</b> CEC y seis Sigma: Alternativas en <em>R</em></a></li>
<li class="chapter" data-level="1.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#etapa-definir"><i class="fa fa-check"></i><b>1.2</b> Etapa <strong>DEFINIR</strong></a><ul>
<li class="chapter" data-level="1.2.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#mapa-de-procesos"><i class="fa fa-check"></i><b>1.2.1</b> Mapa de Procesos</a></li>
<li class="chapter" data-level="1.2.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#diagrama-de-ishikawa-o-espina-de-pescado"><i class="fa fa-check"></i><b>1.2.2</b> Diagrama de Ishikawa o espina de pescado</a></li>
<li class="chapter" data-level="1.2.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#diagrama-de-pareto"><i class="fa fa-check"></i><b>1.2.3</b> Diagrama de Pareto</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#epata-analizar-anova"><i class="fa fa-check"></i><b>1.3</b> Epata <strong>ANALIZAR</strong>: ANOVA</a><ul>
<li class="chapter" data-level="1.3.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#introduccion"><i class="fa fa-check"></i><b>1.3.1</b> Introducción</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#etapa-medir"><i class="fa fa-check"></i><b>1.4</b> Etapa <strong>MEDIR</strong></a><ul>
<li class="chapter" data-level="1.4.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#estudios-rr"><i class="fa fa-check"></i><b>1.4.1</b> Estudios R&amp;R</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#etapa-control"><i class="fa fa-check"></i><b>1.5</b> Etapa <strong>CONTROL</strong>:</a><ul>
<li class="chapter" data-level="1.5.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#graficos-de-control"><i class="fa fa-check"></i><b>1.5.1</b> Gráficos de control</a></li>
<li class="chapter" data-level="1.5.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#graficos-de-control-por-variables"><i class="fa fa-check"></i><b>1.5.2</b> Graficos de control por variables</a></li>
<li class="chapter" data-level="1.5.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#graficos-de-control-para-atributos"><i class="fa fa-check"></i><b>1.5.3</b> Gráficos de control para atributos</a></li>
<li class="chapter" data-level="1.5.4" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#otros-graficos-de-control-univariante"><i class="fa fa-check"></i><b>1.5.4</b> Otros graficos de Control univariante</a></li>
<li class="chapter" data-level="1.5.5" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#curvas-oc"><i class="fa fa-check"></i><b>1.5.5</b> Curvas OC</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#etapa-analizar-analisis-de-capacidad"><i class="fa fa-check"></i><b>1.6</b> Etapa <strong>ANALIZAR</strong>: Analisis de capacidad</a><ul>
<li class="chapter" data-level="1.6.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#introduccion-1"><i class="fa fa-check"></i><b>1.6.1</b> Introducción</a></li>
<li class="chapter" data-level="1.6.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#indices-de-capacidad"><i class="fa fa-check"></i><b>1.6.2</b> Indices de capacidad</a></li>
<li class="chapter" data-level="1.6.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#analisis-de-capacidad-en-r"><i class="fa fa-check"></i><b>1.6.3</b> Analisis de capacidad en R</a></li>
<li class="chapter" data-level="1.6.4" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#analisis-de-capacidad-con-datos-no-normales"><i class="fa fa-check"></i><b>1.6.4</b> Análisis de capacidad con datos no normales</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#etapa-controlar-y-analizar"><i class="fa fa-check"></i><b>1.7</b> Etapa <strong>CONTROLAR</strong> y <strong>ANALIZAR</strong></a><ul>
<li class="chapter" data-level="1.7.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#cec-multivariante-reduccion-de-la-dimencion"><i class="fa fa-check"></i><b>1.7.1</b> CEC multivariante: Reducción de la Dimención</a></li>
<li class="chapter" data-level="1.7.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#cec-para-variables-autocorrelacionadas"><i class="fa fa-check"></i><b>1.7.2</b> CEC para variables autocorrelacionadas</a></li>
<li class="chapter" data-level="1.7.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#analisis-de-capacidad-para-datos-autocorrelados"><i class="fa fa-check"></i><b>1.7.3</b> Análisis de capacidad para datos autocorrelados</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#introduccion-al-diseno-de-experimentos-con-r"><i class="fa fa-check"></i><b>1.8</b> Introducción al diseño de experimentos con R</a><ul>
<li class="chapter" data-level="1.8.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#ejemplos-de-contrastes-anova"><i class="fa fa-check"></i><b>1.8.1</b> Ejemplos de contrastes ANOVA</a></li>
<li class="chapter" data-level="1.8.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#diseno-de-experimentos-factorial-2k"><i class="fa fa-check"></i><b>1.8.2</b> Diseño de experimentos factorial <span class="math inline">\(2^k\)</span></a></li>
<li class="chapter" data-level="1.8.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#diseno-de-experimentos-factoriales-fraccionarios"><i class="fa fa-check"></i><b>1.8.3</b> Diseño de experimentos factoriales fraccionarios</a></li>
<li class="chapter" data-level="1.8.4" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#estudios-interlaboratorios"><i class="fa fa-check"></i><b>1.8.4</b> Estudios Interlaboratorios</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Practicas</b></span></li>
<li class="chapter" data-level="2" data-path="practica-1.html"><a href="practica-1.html"><i class="fa fa-check"></i><b>2</b> Práctica 1</a><ul>
<li class="chapter" data-level="2.1" data-path="practica-1.html"><a href="practica-1.html#cec-y-seis-signa-alternativas-en-r"><i class="fa fa-check"></i><b>2.1</b> CEC y Seis Signa: alternativas en R</a></li>
<li class="chapter" data-level="2.2" data-path="practica-1.html"><a href="practica-1.html#etapa-definir-mapas-de-procesos-ishikawa-pareto"><i class="fa fa-check"></i><b>2.2</b> Etapa <em>DEFINIR</em>: Mapas de procesos, Ishikawa, Pareto</a><ul>
<li class="chapter" data-level="2.2.1" data-path="practica-1.html"><a href="practica-1.html#pizza"><i class="fa fa-check"></i><b>2.2.1</b> Mapas de procesos</a></li>
<li class="chapter" data-level="2.2.2" data-path="practica-1.html"><a href="practica-1.html#ishikawa"><i class="fa fa-check"></i><b>2.2.2</b> DIAGRAMA DE ISHIKAWA</a></li>
<li class="chapter" data-level="2.2.3" data-path="practica-1.html"><a href="practica-1.html#par"><i class="fa fa-check"></i><b>2.2.3</b> DIAGRAMA DE PARETO</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="practica-1.html"><a href="practica-1.html#anova"><i class="fa fa-check"></i><b>2.3</b> Etapa <em>ANALIZAR</em>: ANOVA</a></li>
<li class="chapter" data-level="2.4" data-path="practica-1.html"><a href="practica-1.html#RyR"><i class="fa fa-check"></i><b>2.4</b> Etapa <em>MEDIR</em>: Estudios R&amp;R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="practica-2.html"><a href="practica-2.html"><i class="fa fa-check"></i><b>3</b> Práctica 2</a><ul>
<li class="chapter" data-level="3.1" data-path="practica-2.html"><a href="practica-2.html#graficos-de-control-1"><i class="fa fa-check"></i><b>3.1</b> Gráficos de Control</a></li>
<li class="chapter" data-level="3.2" data-path="practica-2.html"><a href="practica-2.html#graficos-de-control-por-variables-1"><i class="fa fa-check"></i><b>3.2</b> Gráficos de Control por variables</a><ul>
<li class="chapter" data-level="3.2.1" data-path="practica-2.html"><a href="practica-2.html#gqcc"><i class="fa fa-check"></i><b>3.2.1</b> Gráficos qcc para variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="practica-2.html"><a href="practica-2.html#grafico-de-control-para-el-rango-y-la-media-datos-plates"><i class="fa fa-check"></i><b>3.2.2</b> Gráfico de control para el RANGO y la MEDIA: datos “plates”</a></li>
<li class="chapter" data-level="3.2.3" data-path="practica-2.html"><a href="practica-2.html#renderizado"><i class="fa fa-check"></i><b>3.2.3</b> Grafico de control para valores individuales de las variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="practica-2.html"><a href="practica-2.html#graficos-de-control-por-atributos"><i class="fa fa-check"></i><b>3.3</b> Gráficos de control por atributos</a><ul>
<li class="chapter" data-level="3.3.1" data-path="practica-2.html"><a href="practica-2.html#P"><i class="fa fa-check"></i><b>3.3.1</b> Gráficos p</a></li>
<li class="chapter" data-level="3.3.2" data-path="practica-2.html"><a href="practica-2.html#np"><i class="fa fa-check"></i><b>3.3.2</b> Gráfico tipo np</a></li>
<li class="chapter" data-level="3.3.3" data-path="practica-2.html"><a href="practica-2.html#gc"><i class="fa fa-check"></i><b>3.3.3</b> Gráficos C</a></li>
<li class="chapter" data-level="3.3.4" data-path="practica-2.html"><a href="practica-2.html#gu"><i class="fa fa-check"></i><b>3.3.4</b> Gráficos U</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="practica-2.html"><a href="practica-2.html#otros-graficos-de-control-cusum-y-ewma"><i class="fa fa-check"></i><b>3.4</b> Otros gráficos de Control: CUSUM y EWMA</a><ul>
<li class="chapter" data-level="3.4.1" data-path="practica-2.html"><a href="practica-2.html#cusum"><i class="fa fa-check"></i><b>3.4.1</b> GRÀFICOS CUSUM</a></li>
<li class="chapter" data-level="3.4.2" data-path="practica-2.html"><a href="practica-2.html#ewma"><i class="fa fa-check"></i><b>3.4.2</b> GRÁFICOS EWMA</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="practica-2.html"><a href="practica-2.html#oc"><i class="fa fa-check"></i><b>3.5</b> CURVAS OC</a><ul>
<li class="chapter" data-level="3.5.1" data-path="practica-2.html"><a href="practica-2.html#curvas-oc-para-grafica-de-variables"><i class="fa fa-check"></i><b>3.5.1</b> Curvas OC para gráfica de variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practica-3.html"><a href="practica-3.html"><i class="fa fa-check"></i><b>4</b> Práctica 3</a><ul>
<li class="chapter" data-level="4.1" data-path="practica-3.html"><a href="practica-3.html#etapa-analizar-analisis-de-la-capacidad"><i class="fa fa-check"></i><b>4.1</b> Etapa <em>ANALIZAR</em>: Análisis de la capacidad</a><ul>
<li class="chapter" data-level="4.1.1" data-path="practica-3.html"><a href="practica-3.html#analisis-de-capacidad-con-r"><i class="fa fa-check"></i><b>4.1.1</b> Análisis de capacidad con R:</a></li>
<li class="chapter" data-level="4.1.2" data-path="practica-3.html"><a href="practica-3.html#analisis-de-la-capacidad-con-datos-no-normales"><i class="fa fa-check"></i><b>4.1.2</b> Análisis de la capacidad con datos no normales</a></li>
<li class="chapter" data-level="4.1.3" data-path="practica-3.html"><a href="practica-3.html#Piedra"><i class="fa fa-check"></i><b>4.1.3</b> Caso Práctico</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practica-4.html"><a href="practica-4.html"><i class="fa fa-check"></i><b>5</b> Práctica 4</a><ul>
<li class="chapter" data-level="5.1" data-path="practica-4.html"><a href="practica-4.html#etapa-controlar-y-analizar-1"><i class="fa fa-check"></i><b>5.1</b> Etapa Controlar y Analizar</a><ul>
<li class="chapter" data-level="5.1.1" data-path="practica-4.html"><a href="practica-4.html#control-estadistico-de-calidad-multivariante"><i class="fa fa-check"></i><b>5.1.1</b> Control Estadistico de Calidad Multivariante:</a></li>
<li class="chapter" data-level="5.1.2" data-path="practica-4.html"><a href="practica-4.html#control-de-calidad-de-variables-autocorreladas"><i class="fa fa-check"></i><b>5.1.2</b> Control de Calidad de variables autocorreladas</a></li>
<li class="chapter" data-level="5.1.3" data-path="practica-4.html"><a href="practica-4.html#autocorr"><i class="fa fa-check"></i><b>5.1.3</b> Análisis de capacidad con datos autocorrelados.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="practica-5.html"><a href="practica-5.html"><i class="fa fa-check"></i><b>6</b> Práctica 5</a><ul>
<li class="chapter" data-level="6.1" data-path="practica-5.html"><a href="practica-5.html#introduccion-al-diseno-de-experimentos-con-r-1"><i class="fa fa-check"></i><b>6.1</b> Introducción al diseño de experimentos con R</a><ul>
<li class="chapter" data-level="6.1.1" data-path="practica-5.html"><a href="practica-5.html#ejemplos-de-pruebas-anova"><i class="fa fa-check"></i><b>6.1.1</b> Ejemplos de Pruebas ANOVA</a></li>
<li class="chapter" data-level="6.1.2" data-path="practica-5.html"><a href="practica-5.html#disenos-factoriales"><i class="fa fa-check"></i><b>6.1.2</b> DISEÑOS FACTORIALES</a></li>
<li class="chapter" data-level="6.1.3" data-path="practica-5.html"><a href="practica-5.html#disenos-de-experimentos-factoriales-fraccionados"><i class="fa fa-check"></i><b>6.1.3</b> DISEÑOS DE EXPERIMENTOS FACTORIALES FRACCIONADOS</a></li>
<li class="chapter" data-level="6.1.4" data-path="practica-5.html"><a href="practica-5.html#estudios-interlaboratorio-caso-particular-de-doe-y-estudios-rr"><i class="fa fa-check"></i><b>6.1.4</b> ESTUDIOS INTERLABORATORIO (CASO PARTICULAR DE DOE Y ESTUDIOS R&amp;R)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Control Estadístico de la Calidad</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="practica-4" class="section level1">
<h1><span class="header-section-number">Capítulo 5</span> Práctica 4</h1>
<div id="etapa-controlar-y-analizar-1" class="section level2">
<h2><span class="header-section-number">5.1</span> Etapa Controlar y Analizar</h2>
<div id="control-estadistico-de-calidad-multivariante" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Control Estadistico de Calidad Multivariante:</h3>
<div id="queroseno" class="section level4">
<h4><span class="header-section-number">5.1.1.1</span> Caso práctico: Control del contenido de contaminantes en el queroseno.</h4>
<p>Se carga la base de datos del contenido en contaminantes (agua y sólidos) en queroseno, aguas abajo del filtro, justo antes de su inyección en el tanque de combustible de un avión.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#librerias</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(qcc)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(qcr)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(qualityTools)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(SixSigma)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(nortest)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">Contaminacion=<span class="kw">read.table</span>(<span class="st">&quot;Contaminacion.txt&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3">Contaminacion</a></code></pre></div>
<pre><code>##          Agua     Solidos
## 1    7.402681 0.190930324
## 2    9.771126 0.112869846
## 3    9.393595 0.124389822
## 4   13.372208 0.015461550
## 5   17.620823 0.052777521
## 6    9.395278 0.050060051
## 7    8.031297 0.096234660
## 8    8.774855 0.195435189
## 9   10.780045 0.214949280
## 10   5.404965 0.123844500
## 11  10.379421 0.097279939
## 12  12.765760 0.162219308
## 13   5.102952 0.179774154
## 14   7.131309 0.172663561
## 15   6.578566 0.090056306
## 16  10.633311 0.034264061
## 17  10.148315 0.172646526
## 18   8.573035 0.030473052
## 19  12.374178 0.017828928
## 20  12.544260 0.000000000
## 21  13.629888 0.205101196
## 22  14.829833 0.007868192
## 23  15.153030 0.073617165
## 24  12.287752 0.273531260
## 25   9.244134 0.011234451
## 26  10.525326 0.205963363
## 27  13.842711 0.192160331
## 28   8.813001 0.170891917
## 29   9.264689 0.066254550
## 30   9.722806 0.086344393
## 31  15.984433 0.013864369
## 32   5.238274 0.257000287
## 33   5.035533 0.027351509
## 34  14.924394 0.131306407
## 35   6.660098 0.127633810
## 36   7.542646 0.094619125
## 37   5.199361 0.084951407
## 38  10.171844 0.208454718
## 39   9.554239 0.104857708
## 40  10.075462 0.089650315
## 41  10.371507 0.048076717
## 42   6.557636 0.215118027
## 43  11.583945 0.048531683
## 44   9.287104 0.025367453
## 45  12.501666 0.122852765
## 46  14.331369 0.146691137
## 47  18.862215 0.193170612
## 48   7.521767 0.082377890
## 49   9.310584 0.191373673
## 50  15.026589 0.100085732
## 51  11.001580 0.074658770
## 52  10.683831 0.190846359
## 53   9.020982 0.106676875
## 54   4.832568 0.131505711
## 55  12.019808 0.161584637
## 56   8.785676 0.090756522
## 57   4.934583 0.152127616
## 58   8.987616 0.268966379
## 59  11.511131 0.039981236
## 60   8.079746 0.010356682
## 61   7.295403 0.115334043
## 62   5.702187 0.036705457
## 63  11.411383 0.194733846
## 64   8.605553 0.008731298
## 65   8.579302 0.078180568
## 66  11.313893 0.158195939
## 67  12.525698 0.117941001
## 68  12.481995 0.089571689
## 69  10.822331 0.243659602
## 70  16.966018 0.165494754
## 71   9.210591 0.073951899
## 72  10.592792 0.251085804
## 73   7.139039 0.197889778
## 74  12.092446 0.191897347
## 75   4.157249 0.199559387
## 76  15.824896 0.124931832
## 77  14.131728 0.077547806
## 78  11.663469 0.087128256
## 79   8.126862 0.051614274
## 80   4.040020 0.175787023
## 81   9.254390 0.048615793
## 82   9.003185 0.140693887
## 83  12.447158 0.108289530
## 84   4.648495 0.120855259
## 85   5.448563 0.179933125
## 86   9.415969 0.165291015
## 87  11.976278 0.091743170
## 88   8.137679 0.074382962
## 89   8.781807 0.091824073
## 90  10.352384 0.213617912
## 91  11.021430 0.160545053
## 92  16.464110 0.076549586
## 93  10.969676 0.100347119
## 94   9.872342 0.056330391
## 95   7.824515 0.203396024
## 96   8.637530 0.189586611
## 97  14.349403 0.185472334
## 98  15.306337 0.133664955
## 99  11.407374 0.161441789
## 100 13.158853 0.000000000</code></pre>
<p>Normativa: el contenido de agua en el queroseno no ha de ser superior a 15 ppm, el contenido de sólidos en el queroseno ho ha de ser superior a 0.26 mg/L.</p>
<p>¿Cómo hacer un control del contenido en contaminantes cuando hay 2 características CTQ?</p>
</div>
<div id="BONFERRONI" class="section level4">
<h4><span class="header-section-number">5.1.1.2</span> Aproximación univariante utilizando una corrección tipo BONFERRONI.</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Se comprueba la normalidad de los datos:</span></a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">library</span>(nortest)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">lillie.test</span>(Contaminacion<span class="op">$</span>Solidos) <span class="co"># Normal</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  Contaminacion$Solidos
## D = 0.076413, p-value = 0.161</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">lillie.test</span>(Contaminacion[,<span class="st">&quot;Agua&quot;</span>]) <span class="co"># Normal</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  Contaminacion[, &quot;Agua&quot;]
## D = 0.056364, p-value = 0.6061</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># ¿Hay autocorrelación en la variable sólidos?, ¿y en la variable contenido en agua?</span></a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">library</span>(stats)</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co"># H0: independencia de las observaciones</span></a>
<a class="sourceLine" id="cb8-6" title="6"></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw">Box.test</span>(Contaminacion<span class="op">$</span>Solidos) <span class="co"># La observación actual no depende de la anterior</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  Contaminacion$Solidos
## X-squared = 0.65657, df = 1, p-value = 0.4178</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">Box.test</span>(Contaminacion<span class="op">$</span>Agua) <span class="co"># La observación actual no depende de la anterior</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  Contaminacion$Agua
## X-squared = 1.8689, df = 1, p-value = 0.1716</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># Entonces se pueden aplicar gráficos de Shewhart para la media de forma fiable:</span></a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">library</span>(qcc)</a>
<a class="sourceLine" id="cb12-4" title="4"></a>
<a class="sourceLine" id="cb12-5" title="5">agua=<span class="kw">qcc.groups</span>(Contaminacion<span class="op">$</span>Agua,<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>,<span class="dt">each=</span><span class="dv">4</span>)) <span class="co"># se agrupan las medidas de 4 en 4.</span></a>
<a class="sourceLine" id="cb12-6" title="6">solidos=<span class="kw">qcc.groups</span>(Contaminacion<span class="op">$</span>Solidos,<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>,<span class="dt">each=</span><span class="dv">4</span>)) <span class="co"># se agrupan las medidas de 4 en 4.</span></a>
<a class="sourceLine" id="cb12-7" title="7"></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co"># Se aplica la corrección de Bonferroni apuntada por Artl, con un nivel de significación alfa/(2*nº variables) = 0.0027/4=0.000675</span></a>
<a class="sourceLine" id="cb12-9" title="9"></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="kw">qcc</span>(agua,<span class="dt">type=</span><span class="st">&quot;xbar&quot;</span>,<span class="dt">confidence.level=</span>(<span class="dv">1</span><span class="fl">-0.000675</span>))</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre><code>## List of 11
##  $ call            : language qcc(data = agua, type = &quot;xbar&quot;, confidence.level = (1 - 0.000675))
##  $ type            : chr &quot;xbar&quot;
##  $ data.name       : chr &quot;agua&quot;
##  $ data            : num [1:25, 1:4] 7.4 17.6 10.8 5.1 10.1 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics      : Named num [1:25] 9.98 10.96 9.83 7.36 10.91 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:25] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes           : Named int [1:25] 4 4 4 4 4 4 4 4 4 4 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:25] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ center          : num 10.2
##  $ std.dev         : num 3.3
##  $ confidence.level: num 0.999
##  $ limits          : num [1, 1:2] 4.59 15.82
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations      :List of 2
##  - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">qcc</span>(solidos,<span class="dt">type=</span><span class="st">&quot;xbar&quot;</span>,<span class="dt">confidence.level=</span>(<span class="dv">1</span><span class="fl">-0.000675</span>))</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<pre><code>## List of 11
##  $ call            : language qcc(data = solidos, type = &quot;xbar&quot;, confidence.level = (1 - 0.000675))
##  $ type            : chr &quot;xbar&quot;
##  $ data.name       : chr &quot;solidos&quot;
##  $ data            : num [1:25, 1:4] 0.1909 0.0528 0.2149 0.1798 0.1726 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics      : Named num [1:25] 0.1109 0.0986 0.1496 0.1192 0.0552 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:25] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes           : Named int [1:25] 4 4 4 4 4 4 4 4 4 4 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:25] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ center          : num 0.121
##  $ std.dev         : num 0.0727
##  $ confidence.level: num 0.999
##  $ limits          : num [1, 1:2] -0.00251 0.24472
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations      :List of 2
##  - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
</div>
<div id="Shewhart" class="section level4">
<h4><span class="header-section-number">5.1.1.3</span> Control de calidad multivariante con gráficos Shewhart (T2 Hotelling).</h4>
<p><strong>CONTROL MULTIVARIANTE TIPO SHEWART</strong></p>
<p>Comprobar si las variables aleatorias a controlar siguen una distribución multinormal (SE UTILIZA EL TEST DE MARDIA, cargando la librería MVN):</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">library</span>(MVN)</a></code></pre></div>
<pre><code>## Warning: package &#39;MVN&#39; was built under R version 3.6.1</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<pre><code>## sROC 0.1-2 loaded</code></pre>
<pre><code>## 
## Attaching package: &#39;MVN&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:mgcv&#39;:
## 
##     mvn</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">mardiaTest</span>(Contaminacion, <span class="dt">cov =</span> <span class="ot">TRUE</span>, <span class="dt">qqplot =</span> <span class="ot">TRUE</span>) <span class="co"># Es multinormal</span></a></code></pre></div>
<pre><code>## Warning: &#39;mardiaTest&#39; is deprecated.
## Use &#39;mvn&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<p>La función a emplear es mqcc, de la librería qcc permite calcular gráficos de control T2 para MEDIAS de la variable y para MEDIDAS INDIVIDUALES.</p>
<p><strong>Control de medias con datos agrupados</strong></p>
<p>Se agrupan los datos en muestras de 4 elementos:</p>
<p>Calibrado: obtención de los límites de control a partir de 25 muestras racionales</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">x1=<span class="kw">matrix</span>(Contaminacion[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">1</span>],<span class="dt">nc=</span><span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb24-2" title="2">x2=<span class="kw">matrix</span>(Contaminacion[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">2</span>],<span class="dt">nc=</span><span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb24-3" title="3">X=<span class="kw">list</span>(x1,x2)</a>
<a class="sourceLine" id="cb24-4" title="4"></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="co"># x1new=matrix(Contaminacion[85:100,1],nc=4, byrow=TRUE) </span></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="co"># x2new=matrix(Contaminacion[85:100,2],nc=4, byrow=TRUE)</span></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="co"># Xnew=list(x1new,x2new)</span></a>
<a class="sourceLine" id="cb24-8" title="8"></a>
<a class="sourceLine" id="cb24-9" title="9"></a>
<a class="sourceLine" id="cb24-10" title="10"><span class="co"># Muestra de Monitorizado (20 muestras racionales de 4 observaciones):</span></a>
<a class="sourceLine" id="cb24-11" title="11"></a>
<a class="sourceLine" id="cb24-12" title="12">ContaminacionNew=<span class="kw">read.table</span>(<span class="st">&quot;ContaminacionNew.txt&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb24-13" title="13">x1new=<span class="kw">matrix</span>(ContaminacionNew[,<span class="dv">1</span>],<span class="dt">nc=</span><span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb24-14" title="14">x2new=<span class="kw">matrix</span>(ContaminacionNew[,<span class="dv">2</span>],<span class="dt">nc=</span><span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb24-15" title="15">Xnew=<span class="kw">list</span>(x1new,x2new)</a></code></pre></div>
<p>Gráfico de control con mqcc. Los límites para la muestra de calibrado son más estrechos que los de la muestra de monitorizado (ver Montgomery, 2001).
Se recomienda, de ser posible, usar siempre más de 20 grupos y, a menudo, más de m = 50 para formar la muestra de calibrado y estimar los límites de control.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">q1=<span class="kw">mqcc</span>(X,<span class="dt">newdata=</span>Xnew, <span class="dt">type =</span> <span class="st">&quot;T2&quot;</span>, <span class="dt">pred.limits =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># medidas descriptivas del estadistico T2, nº variab., nº grupos, nºobser./grupo,</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="co"># vector de medias, matriz de covarianzas muestral, límites de control:</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="kw">summary</span>(q1) </a></code></pre></div>
<pre><code>## 
## Call:
## mqcc(data = X, type = &quot;T2&quot;, pred.limits = TRUE, newdata = Xnew)
## 
## T2 chart for X 
## 
## Summary of group statistics:
##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.120144 0.623034 1.182196 1.950055 2.929308 6.888580 
## 
## Number of variables:  2
## Number of groups:  25
## Group sample size:  4
## 
## Center: 
##       X[1]       X[2] 
## 10.2024968  0.1211044 
## 
## Covariance matrix:
##             X[1]         X[2]
## X[1]  9.84551114 -0.047799211
## X[2] -0.04779921  0.005247199
## |S|:  0.04937659 
## 
## Summary of group statistics in Xnew:
##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
##  0.796210  2.359529  3.670768  4.893884  6.935830 20.217114 
## 
## Number of groups:  20
## Group sample size:  4
## 
## Control limits:
##  LCL      UCL
##    0 10.91536
## 
## Prediction limits:
##  LPL      UPL
##    0 11.82498</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># La observación 35 se detecta como fuera de control:</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw">names</span>(q1);q1<span class="op">$</span>violation<span class="op">$</span>beyond.pred.limits </a></code></pre></div>
<pre><code>##  [1] &quot;call&quot;             &quot;data.name&quot;        &quot;var.names&quot;       
##  [4] &quot;data&quot;             &quot;type&quot;             &quot;confidence.level&quot;
##  [7] &quot;statistics&quot;       &quot;means&quot;            &quot;center&quot;          
## [10] &quot;cov&quot;              &quot;newdata&quot;          &quot;newdata.name&quot;    
## [13] &quot;newstats&quot;         &quot;newmeans&quot;         &quot;limits&quot;          
## [16] &quot;pred.limits&quot;      &quot;violations&quot;</code></pre>
<pre><code>## [1] 35</code></pre>
<p>Si tenemos solo dos variables, se puede realizar un grafico de elipse, circunferencia si las variables son independientes (sólo para control de la media de la variable CTQ).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">ellipseChart</span>(q1, <span class="dt">show.id =</span> <span class="ot">TRUE</span>, <span class="dt">chart.all =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">                                 <span class="co"># con show.id se identifica cada observación según su</span></a>
<a class="sourceLine" id="cb32-2" title="2">                                 <span class="co"># secuencia temporal</span></a>
<a class="sourceLine" id="cb32-3" title="3">                                 <span class="co"># LA OBSERVACIÓN 10 DE LA M. DE MONITOR. ESTÁ FUERA</span></a>
<a class="sourceLine" id="cb32-4" title="4">                                 <span class="co"># DE CONTROL.</span></a></code></pre></div>
<p><strong>Control de medidas individuales</strong></p>
<p>También es posible obtener el gráfico T2 de Hotelling para medidas individuales. Se empleará la función mqcc con type = “T2.single”:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">qq =<span class="st"> </span><span class="kw">mqcc</span>(Contaminacion, <span class="dt">type =</span> <span class="st">&quot;T2.single&quot;</span>,<span class="dt">newdata =</span> ContaminacionNew, </a>
<a class="sourceLine" id="cb33-2" title="2">          <span class="dt">pred.limits =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">qq<span class="op">$</span>violations<span class="op">$</span>beyond.pred.limits <span class="co"># Las observaciones 137 y 139 están fuera de control</span></a></code></pre></div>
<pre><code>## [1] 137 139</code></pre>
</div>
<div id="MEWMA" class="section level4">
<h4><span class="header-section-number">5.1.1.4</span> Control de calidad multivariante con gráficos MEWMA y MCUSUM.</h4>
<p>Detectan mejor los cambios pequeños en el proceso debido a que tienen memoria:
cada punto representado se calcula teniendo en cuenta, aparte de la actual, las
observaciones anteriores.</p>
<p>Se utiliza el paquete qcr, elaborado por Miguel Flores</p>
<p>Los gráficos MCUSUM y MEWMA estan implementados sólo para el control de medidas individuales</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">library</span>(qcr)</a></code></pre></div>
<p><strong>CUSUM: gráfico de las diferencias acumumadas con respecto al vector de medias</strong></p>
<p>Función mqcd para crear el objeto multivariante y mqcs.mcusum para obtener el gráfico multivariante:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># Muestra de calibrado:</span></a>
<a class="sourceLine" id="cb37-2" title="2">data.mqcd &lt;-<span class="st"> </span><span class="kw">mqcd</span>(Contaminacion)  </a>
<a class="sourceLine" id="cb37-3" title="3">res.mqcs &lt;-<span class="st"> </span><span class="kw">mqcs.mcusum</span>(data.mqcd)</a>
<a class="sourceLine" id="cb37-4" title="4"><span class="kw">summary</span>(res.mqcs) <span class="co"># Resumen de las principales características del gráfico de control</span></a></code></pre></div>
<pre><code>## 
## Summary of group statistics:
##        V1        
##  Min.   :0.0000  
##  1st Qu.:0.7687  
##  Median :1.2954  
##  Mean   :1.5467  
##  3rd Qu.:2.2837  
##  Max.   :4.3011  
## 
## Number of quality characteristics:  2
## Number of samples or observations:  100
## Number of observations or sample size:  1
## 
## Mean Vector: 
##  10.2025 0.1211044
## Covariance Matrix:
##             Agua      Solidos
## [1,] 10.39533177 -0.022928656
## [2,] -0.02292866  0.004750744
## 
## Control limits: 
## lcl ucl 
## 0.0 5.5 
## 
## Number beyond limits: 0</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">plot</span>(res.mqcs, <span class="dt">title =</span><span class="st">&quot; MCUSUM Control Chart for Water and Solids in Jet Fuel&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co"># Muestra de monitorizado:</span></a>
<a class="sourceLine" id="cb40-2" title="2">data.mqcd.new &lt;-<span class="st"> </span><span class="kw">mqcd</span>(ContaminacionNew)</a>
<a class="sourceLine" id="cb40-3" title="3"></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="co"># Se toman el vector de medias y la matriz de covarianzas de la muestra de calibrado</span></a>
<a class="sourceLine" id="cb40-5" title="5">Xmv=<span class="kw">matrix</span>(res.mqcs<span class="op">$</span>mean,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb40-6" title="6">S =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(res.mqcs<span class="op">$</span>S,<span class="dt">byrow=</span><span class="ot">FALSE</span>,<span class="dt">nc=</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb40-7" title="7"></a>
<a class="sourceLine" id="cb40-8" title="8"><span class="co"># Se calcula el nuevo gráfico con los límites obtenidos en la muestra de calibrado:</span></a>
<a class="sourceLine" id="cb40-9" title="9">res.mqcs.new &lt;-<span class="st"> </span><span class="kw">mqcs.mcusum</span>(data.mqcd.new,<span class="dt">Xmv=</span>Xmv,<span class="dt">S=</span>S)</a>
<a class="sourceLine" id="cb40-10" title="10"><span class="kw">plot</span>(res.mqcs.new, <span class="dt">title =</span><span class="st">&quot; MCUSUM Control Chart for Water and Solids in Jet Fuel&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">names</span>(res.mqcs.new);res.mqcs.new<span class="op">$</span>violations.</a></code></pre></div>
<pre><code>##  [1] &quot;mqcd&quot;       &quot;type&quot;       &quot;statistics&quot; &quot;mean&quot;       &quot;S&quot;         
##  [6] &quot;k&quot;          &quot;h&quot;          &quot;limits&quot;     &quot;data.name&quot;  &quot;violations&quot;</code></pre>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co"># A partir de la observación 18 de la muestra de monitorizado, se muestra</span></a>
<a class="sourceLine" id="cb44-2" title="2"><span class="co"># que el proceso se ha desplazado respecto al vector de medias calculado en</span></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co"># la muestra de calibrado.</span></a></code></pre></div>
<p><strong>EWMA: gráfico de las medias móviles ponderadas exponencialmente</strong></p>
<p>Función mqcd para crear el objeto multivariante y mqcs.mewma para obtener el gráfico multivariante:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># Muestra de calibrado:</span></a>
<a class="sourceLine" id="cb45-2" title="2">data.mqcd &lt;-<span class="st"> </span><span class="kw">mqcd</span>(Contaminacion)</a>
<a class="sourceLine" id="cb45-3" title="3">res.mqcs &lt;-<span class="st"> </span><span class="kw">mqcs.mewma</span>(data.mqcd)</a>
<a class="sourceLine" id="cb45-4" title="4"><span class="kw">summary</span>(res.mqcs)</a></code></pre></div>
<pre><code>## 
## Summary of group statistics:
##        V1          
##  Min.   :0.008703  
##  1st Qu.:0.485543  
##  Median :1.235444  
##  Mean   :1.287885  
##  3rd Qu.:1.841987  
##  Max.   :4.251642  
## 
## Number of quality characteristics:  2
## Number of samples or observations:  100
## Number of observations or sample size:  1
## 
## Mean Vector: 
##  10.2025 0.1211044
## Covariance Matrix:
##             Agua      Solidos
## [1,] 10.39533177 -0.022928656
## [2,] -0.02292866  0.004750744
## 
## Control limits: 
##    lcl    ucl 
## 0.0000 8.6336 
## 
## Number beyond limits: 0</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">plot</span>(res.mqcs, <span class="dt">title =</span><span class="st">&quot; MEWMA Control Chart for Water and Solids in Jet Fuel&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># Muestra de monitorizado:</span></a>
<a class="sourceLine" id="cb48-2" title="2">data.mqcd.new &lt;-<span class="st"> </span><span class="kw">mqcd</span>(ContaminacionNew)</a>
<a class="sourceLine" id="cb48-3" title="3"></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="co"># Se toman el vector de medias y la matriz de covarianzas de la muestra de calibrado</span></a>
<a class="sourceLine" id="cb48-5" title="5">Xmv=<span class="kw">matrix</span>(res.mqcs<span class="op">$</span>mean,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb48-6" title="6">S =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(res.mqcs<span class="op">$</span>S,<span class="dt">byrow=</span><span class="ot">FALSE</span>,<span class="dt">nc=</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb48-7" title="7"></a>
<a class="sourceLine" id="cb48-8" title="8"><span class="co"># Se calcula el nuevo gráfico con los límites obtenidos en la muestra de calibrado:</span></a>
<a class="sourceLine" id="cb48-9" title="9">res.mqcs.new &lt;-<span class="st"> </span><span class="kw">mqcs.mewma</span>(data.mqcd.new,<span class="dt">Xmv=</span>Xmv,<span class="dt">S=</span>S)</a>
<a class="sourceLine" id="cb48-10" title="10"><span class="kw">plot</span>(res.mqcs.new, <span class="dt">title =</span><span class="st">&quot; MEWMA Control Chart for Water and Solids in Jet Fuel&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="kw">names</span>(res.mqcs.new);res.mqcs.new<span class="op">$</span>violations</a></code></pre></div>
<pre><code>## [1] &quot;mqcd&quot;       &quot;type&quot;       &quot;statistics&quot; &quot;mean&quot;       &quot;S&quot;         
## [6] &quot;lambda&quot;     &quot;limits&quot;     &quot;data.name&quot;  &quot;violations&quot;</code></pre>
<pre><code>##  [1]  8 10 18 19 20 21 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39
## [24] 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62
## [47] 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 79 80</code></pre>
<p>A partir de la observación 8 de la muestra de monitorizado, se muestra que el proceso se ha desplazado respecto al vector de medias calculado en la muestra de calibrado.
* CONCLUSIÓN: usando MEWMA, en la observación número 108 (teniendo en cuenta la de calibrado), se observa que el proceso está fuera de control.
Con un gráfico T2, se verifica que el proceso está fuera de control en la observación 137.</p>
<p>Este tipo de gráficos detectan mejor los cambios pequeños y paulatinos.</p>
<div id="caso-practico-cotrol-de-humedad-relativa-temperatura-y-consumo-electrico." class="section level5">
<h5><span class="header-section-number">5.1.1.4.1</span> Caso práctico: Cotrol de humedad relativa, temperatura y consumo eléctrico.</h5>
</div>
</div>
<div id="adjustment" class="section level4">
<h4><span class="header-section-number">5.1.1.5</span> Regression adjustment.</h4>
<p>Se obtienen datos del consumo energético (medido en KW) de una instalación de climatización para mantener unas determinadas condiciones de temperatura, humedad relativa y contenido de CO2.</p>
<p>Supóngase que la característica de calidad del proceso “Confort térmico” de las instalaciones de climatización es su temperatura.</p>
<p>La temperatura depende de las condiciones de humedad en una determinada oficina.
Además, en la base de datos que se muestra hay tres medidas diferentes de la temp. y la humedad relativa, tomadas en tres zonas de la oficina.</p>
<p>Se pretende controlar la temperatura del fondo de la oficina (la variable no es normal).</p>
<p>¿Cómo controlar el proceso?</p>
<p>Una alternativa cuando se tienen varios parámetros que influyen en una característica CTQ a controlar es la aplicacion del metodo: REGRESSION ADJUSTMENT</p>
<p><strong>VENTAJA:</strong> simple, no es necesario aplicar estadisticos con condiciones de optimalidad. El ARL es similar al de gráficos como el T2 y otros.</p>
<p><strong>REQUERIMIENTOS:</strong> (1) dependencia entre variables, (2) para medidas individuales.</p>
<p>PROCEDIMIENTO:
+ A) Se hace una regresión de la caracteristica Y sobre el parámetro X1;
luego, una regresión de los residuos sobre el parámetro X2, y así
sucesivamente con todos los parametros.</p>
<pre><code>+ B) Se hace un gráfico de control de los residuos (muchas veces normales e </code></pre>
<p>independientes).</p>
<p><em>DATOS referidos a las 18:00 de la tarde durante 45 días laborables</em></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">ConTempHRco2=<span class="kw">read.table</span>(<span class="st">&quot;ConTempHRco2.txt&quot;</span>)</a>
<a class="sourceLine" id="cb53-2" title="2"></a>
<a class="sourceLine" id="cb53-3" title="3"><span class="co"># Hay relación entre las variables, hay cierta información redundante:</span></a>
<a class="sourceLine" id="cb53-4" title="4"></a>
<a class="sourceLine" id="cb53-5" title="5"><span class="co"># Antención: cargar antes library(car)</span></a>
<a class="sourceLine" id="cb53-6" title="6"><span class="kw">library</span>(car)</a></code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:qualityTools&#39;:
## 
##     qqPlot</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">windows</span>()</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">scatterplotMatrix</span>(<span class="op">~</span>CO2Entrada<span class="op">+</span>CO2Fondo<span class="op">+</span>CO2Medio<span class="op">+</span>ConsumoUE03<span class="op">+</span>HREntrada<span class="op">+</span>HRFondo<span class="op">+</span>HRMedio<span class="op">+</span>TempEntrada<span class="op">+</span>TempFondo<span class="op">+</span>TempMedio,</a>
<a class="sourceLine" id="cb57-3" title="3">                  <span class="dt">reg.line=</span><span class="ot">FALSE</span>, <span class="dt">smooth=</span><span class="ot">FALSE</span>, <span class="dt">spread=</span><span class="ot">FALSE</span>, <span class="dt">span=</span><span class="fl">0.5</span>, <span class="dt">ellipse=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb57-4" title="4">                  <span class="dt">levels=</span><span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.9</span>), <span class="dt">id.n=</span><span class="dv">0</span>, <span class="dt">diagonal =</span> <span class="st">&#39;density&#39;</span>, <span class="dt">data=</span>ConTempHRco2)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># Efectúo regresiones sucesivas...</span></a>
<a class="sourceLine" id="cb58-2" title="2"></a>
<a class="sourceLine" id="cb58-3" title="3"><span class="co"># de la temperatura del fondo de la habitación sobre la temperatura del medio...</span></a>
<a class="sourceLine" id="cb58-4" title="4">regre1=<span class="kw">lm</span>(ConTempHRco2<span class="op">$</span>TempFondo<span class="op">~</span>ConTempHRco2<span class="op">$</span>TempMedio); <span class="kw">summary</span>(regre1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ConTempHRco2$TempFondo ~ ConTempHRco2$TempMedio)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.91480 -0.27329 -0.03027  0.25650  1.28543 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            10.27987    1.32515   7.758 1.05e-09 ***
## ConTempHRco2$TempMedio  0.62327    0.05143  12.118 1.86e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.42 on 43 degrees of freedom
## Multiple R-squared:  0.7735, Adjusted R-squared:  0.7682 
## F-statistic: 146.8 on 1 and 43 DF,  p-value: 1.86e-15</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co"># de los residuos de la regresión anterior sobre la temperatura de entrada...</span></a>
<a class="sourceLine" id="cb60-2" title="2">regre2=<span class="kw">lm</span>(regre1<span class="op">$</span>residuals<span class="op">~</span>ConTempHRco2<span class="op">$</span>TempEntrada); <span class="kw">summary</span>(regre2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = regre1$residuals ~ ConTempHRco2$TempEntrada)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.70442 -0.28573 -0.00773  0.22007  1.14201 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)               -3.6950     1.6776  -2.203   0.0330 *
## ConTempHRco2$TempEntrada   0.1404     0.0637   2.204   0.0329 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3982 on 43 degrees of freedom
## Multiple R-squared:  0.1015, Adjusted R-squared:  0.0806 
## F-statistic: 4.857 on 1 and 43 DF,  p-value: 0.03293</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># de los residuos de la regresión anterior sobre la humedad relativa del fondo...</span></a>
<a class="sourceLine" id="cb62-2" title="2">regre3=<span class="kw">lm</span>(regre2<span class="op">$</span>residuals<span class="op">~</span>ConTempHRco2<span class="op">$</span>HRFondo); <span class="kw">summary</span>(regre3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = regre2$residuals ~ ConTempHRco2$HRFondo)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.8317 -0.2669  0.0048  0.2390  0.9677 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)          -1.007802   0.497035  -2.028   0.0488 *
## ConTempHRco2$HRFondo  0.020354   0.009973   2.041   0.0474 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3802 on 43 degrees of freedom
## Multiple R-squared:  0.08832,    Adjusted R-squared:  0.06711 
## F-statistic: 4.165 on 1 and 43 DF,  p-value: 0.04743</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="co"># de los residuos de la regresión anterior sobre la humedad relativa del medio...</span></a>
<a class="sourceLine" id="cb64-2" title="2">regre4=<span class="kw">lm</span>(regre3<span class="op">$</span>residuals<span class="op">~</span>ConTempHRco2<span class="op">$</span>HRMedio); <span class="kw">summary</span>(regre4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = regre3$residuals ~ ConTempHRco2$HRMedio)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.84531 -0.26646 -0.00013  0.23238  0.94441 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)          -0.219747   0.885884  -0.248    0.805
## ConTempHRco2$HRMedio  0.004092   0.016464   0.249    0.805
## 
## Residual standard error: 0.3799 on 43 degrees of freedom
## Multiple R-squared:  0.001435,   Adjusted R-squared:  -0.02179 
## F-statistic: 0.06178 on 1 and 43 DF,  p-value: 0.8049</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="co"># de los residuos de la regresión anterior sobre la humedad relativa de la entrada...</span></a>
<a class="sourceLine" id="cb66-2" title="2">regre5=<span class="kw">lm</span>(regre4<span class="op">$</span>residuals<span class="op">~</span>ConTempHRco2<span class="op">$</span>HREntrada); <span class="kw">summary</span>(regre5)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = regre4$residuals ~ ConTempHRco2$HREntrada)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.83534 -0.27627  0.00573  0.24096  0.95649 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)             0.153549   0.729445   0.211    0.834
## ConTempHRco2$HREntrada -0.003068   0.014530  -0.211    0.834
## 
## Residual standard error: 0.3797 on 43 degrees of freedom
## Multiple R-squared:  0.001036,   Adjusted R-squared:  -0.0222 
## F-statistic: 0.04458 on 1 and 43 DF,  p-value: 0.8338</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="co"># Test sobre los residuos correspondientes al primer mes:</span></a>
<a class="sourceLine" id="cb68-2" title="2"></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="kw">lillie.test</span>(regre5<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]) <span class="co"># Normalidad</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  regre5$residuals[1:20]
## D = 0.13866, p-value = 0.3993</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">Box.test</span>(regre5<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]) <span class="co"># No autocorrelación</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  regre5$residuals[1:20]
## X-squared = 0.58081, df = 1, p-value = 0.446</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">lillie.test</span>(ConTempHRco2<span class="op">$</span>TempFondo[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]) <span class="co"># No normalidad en la variable de partida</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  ConTempHRco2$TempFondo[1:20]
## D = 0.28147, p-value = 0.0002135</code></pre>
<p><strong>Aplicación de gráficos de control Sewhart</strong></p>
<p>Gráficos de control para las muestras de calibrado y monitorizado (se toman, por ejemplo, los residuos una vez extraida la dependencia lineal con el resto de temperaturas, regre2):</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">q6=<span class="kw">qcc</span>(regre2<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>],<span class="dt">newdata=</span>regre2<span class="op">$</span>residuals[<span class="dv">21</span><span class="op">:</span><span class="dv">45</span>],<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">q6<span class="op">$</span>violations<span class="op">$</span>beyond.limits</a></code></pre></div>
<pre><code>## [1] 32 33 35</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">q6<span class="op">$</span>violations<span class="op">$</span>violating.runs</a></code></pre></div>
<pre><code>## [1] 36 37 38 26 27 28 29</code></pre>
<p>A partir del segundo mes, la temperatura no está bajo control. Han cambiado las condiciones con respecto al primer mes. Al 6º día nos damos cuenta.</p>
<p>El regression adjustment se podría extender para el caso de regresión lineal generalizada (GLM), aditiva generalizada (GAM) e, incluso, regresión con datos funcionales.</p>
</div>
<div id="pca" class="section level4">
<h4><span class="header-section-number">5.1.1.6</span> Reducción de dimensión: Análisis de componentes principales (PCA).</h4>
<p>A partir de una matriz de datos con “p” variables, se obtiene otra matriz de datos con “p” componentes principales (nuevas variables).
La primera componente principal de las p-componentes se obtiene al proyectar los vectores de observaciones en la dirección de la máxima varianza de los datos. La segunda componente se obtendrá al proyectar la información restante en la dirección de su máxima varianza y así sucesivamente hasta obtener la nuevas p componentes.
Las “p” componentes son ORTOGONALES e INDEPENDIENTES entre sí.</p>
<p>VENTAJAS: Útiles cuando tenemos una gran cantidad de variables. Con cerca de 10 variables los gráficos clásicos no son fiables (el ARL se incrementa al incrementar el nº de variables, se tarda más en detectar un verdadero fuera de control).
Muchas veces se puede resumir la mayor parte de la información de la base de datos en apenas dos variables.
Las proyecciones pueden cumplir las hipótesis de normalidad y no autocorrelación, lo que hace aplicables los gráficos de Shewhart.</p>
<p>INCONVENIENTES: Es difícil descubrir cuál es la variable original que origina el fuera de control y, así, identificar las causas asignables.</p>
<p><strong>PROBLEMA a resolver</strong></p>
<p>Resumir las 9 características del confort térmico y calidad del aire de la oficina en dos variables y aplicar gráficos de control:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co"># Muestra de calibrado (descomposición matricial en valores singulares con svd):</span></a>
<a class="sourceLine" id="cb79-2" title="2">HF.svd &lt;-<span class="st"> </span><span class="kw">svd</span>(ConTempHRco2[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">12</span><span class="op">:</span><span class="dv">14</span>)])</a>
<a class="sourceLine" id="cb79-3" title="3"></a>
<a class="sourceLine" id="cb79-4" title="4"><span class="co"># Se obtiene la matriz de puntuaciones respecto a la nueva base de componentes principales</span></a>
<a class="sourceLine" id="cb79-5" title="5"><span class="co"># al multiplicar matricialmente la matriz u y d, resultado de la descomposición svd:</span></a>
<a class="sourceLine" id="cb79-6" title="6">HF.scores &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(HF.svd<span class="op">$</span>u <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(HF.svd<span class="op">$</span>d))</a>
<a class="sourceLine" id="cb79-7" title="7">PCA &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">scores =</span> HF.svd<span class="op">$</span>u <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(HF.svd<span class="op">$</span>d),<span class="dt">loadings =</span> HF.svd<span class="op">$</span>v)</a>
<a class="sourceLine" id="cb79-8" title="8"> </a>
<a class="sourceLine" id="cb79-9" title="9"><span class="co"># Muestra de monitorizado. Se proyectan las nuevas observaciones (vectores de </span></a>
<a class="sourceLine" id="cb79-10" title="10"><span class="co"># características) en la nueva base:</span></a>
<a class="sourceLine" id="cb79-11" title="11"></a>
<a class="sourceLine" id="cb79-12" title="12">HF_test.scores=<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb79-13" title="13"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">21</span><span class="op">:</span><span class="dv">45</span>){</a>
<a class="sourceLine" id="cb79-14" title="14">  HF_test.scores &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb79-15" title="15"><span class="st">  </span><span class="kw">rbind</span>(HF_test.scores,</a>
<a class="sourceLine" id="cb79-16" title="16">        <span class="kw">as.data.frame</span>(<span class="kw">as.numeric</span>(ConTempHRco2[i,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">12</span><span class="op">:</span><span class="dv">14</span>)]) <span class="op">%*%</span><span class="st">  </span>PCA<span class="op">$</span>loadings))</a>
<a class="sourceLine" id="cb79-17" title="17">  </a>
<a class="sourceLine" id="cb79-18" title="18">}</a></code></pre></div>
<p><strong><span class="math inline">\(T^2\)</span> de Hotelling</strong></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">q10=<span class="kw">mqcc</span>(HF.scores[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],<span class="dt">newdata=</span>HF_test.scores[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;T2.single&quot;</span>),</a>
<a class="sourceLine" id="cb80-2" title="2">         <span class="dt">pred.limits =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Se percibe que el proceso se empieza a descontrolar a partir de la observación 19 de la muestra de monitorizado. Pero si, como se debe, se observan los intervalos de predicción, no se detecta ninguna muestra fuera de control.</p>
<ul>
<li>PRECAUCIÓN: Cuando se reduce a pocas componentes principales, estamos obviando algunas direcciones en las que se producirían posibles desplazamientos hacia el fuera de control.</li>
</ul>
<p>El uso de MEWMA aplicado a las componentes principales retenidas disminuye considerablemente el ARL1:</p>
<p><strong>MEWMA</strong></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="co"># Muestra de calibrado:</span></a>
<a class="sourceLine" id="cb81-2" title="2">data.mqcd &lt;-<span class="st"> </span><span class="kw">mqcd</span>(HF.scores[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb81-3" title="3">res.mqcs &lt;-<span class="st"> </span><span class="kw">mqcs.mewma</span>(data.mqcd)</a>
<a class="sourceLine" id="cb81-4" title="4"><span class="kw">summary</span>(res.mqcs)</a></code></pre></div>
<pre><code>## 
## Summary of group statistics:
##        V1       
##  Min.   :1.668  
##  1st Qu.:2.326  
##  Median :3.139  
##  Mean   :3.074  
##  3rd Qu.:3.716  
##  Max.   :4.335  
## 
## Number of quality characteristics:  2
## Number of samples or observations:  20
## Number of observations or sample size:  1
## 
## Mean Vector: 
##  -1205.909 -3.945748
## Covariance Matrix:
##             V1        V2
## [1,] 63380.407 -5008.645
## [2,] -5008.645  1650.250
## 
## Control limits: 
##    lcl    ucl 
## 0.0000 8.6336 
## 
## Number beyond limits: 0</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">plot</span>(res.mqcs, <span class="dt">title =</span><span class="st">&quot;MEWMA Control Chart for Water and Solids in Jet Fuel&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># Muestra de monitorizado:</span></a>
<a class="sourceLine" id="cb84-2" title="2">data.mqcd.new &lt;-<span class="st"> </span><span class="kw">mqcd</span>(HF_test.scores[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb84-3" title="3"></a>
<a class="sourceLine" id="cb84-4" title="4"><span class="co"># Se toman el vector de medias y la matriz de covarianzas de la muestra de calibrado</span></a>
<a class="sourceLine" id="cb84-5" title="5">Xmv=<span class="kw">matrix</span>(res.mqcs<span class="op">$</span>mean,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb84-6" title="6">S =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(res.mqcs<span class="op">$</span>S,<span class="dt">byrow=</span><span class="ot">FALSE</span>,<span class="dt">nc=</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb84-7" title="7"></a>
<a class="sourceLine" id="cb84-8" title="8"><span class="co"># Se calcula el nuevo gráfico con los límites obtenidos en la muestra de calibrado:</span></a>
<a class="sourceLine" id="cb84-9" title="9">res.mqcs.new &lt;-<span class="st"> </span><span class="kw">mqcs.mewma</span>(data.mqcd.new,<span class="dt">Xmv=</span>Xmv,<span class="dt">S=</span>S)</a>
<a class="sourceLine" id="cb84-10" title="10"><span class="kw">plot</span>(res.mqcs.new, <span class="dt">title =</span><span class="st">&quot; MEWMA Control Chart for Thermal confort and Air quality&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">names</span>(res.mqcs.new);res.mqcs.new<span class="op">$</span>violations</a></code></pre></div>
<pre><code>## [1] &quot;mqcd&quot;       &quot;type&quot;       &quot;statistics&quot; &quot;mean&quot;       &quot;S&quot;         
## [6] &quot;lambda&quot;     &quot;limits&quot;     &quot;data.name&quot;  &quot;violations&quot;</code></pre>
<pre><code>## [1] 4</code></pre>
<p>CONCLUSIÓN: Se identifica que el proceso está fuera de control en la 4ª observación de la muestra de monitorizado.</p>
</div>
<div id="pls" class="section level4">
<h4><span class="header-section-number">5.1.1.7</span> Reducción de dimensión: Mínimos cuadrados parciales (PLS).</h4>
<p>Misma utilidad que las compententes principales, pero con una ventaja fundamental: se expresan los vectores de características según nuevas componentes o variables, pero en la obtención de las mismas se ha tenido en cuenta la existencia de una matriz de variables independientes X y una variable respuesta Y. Los datos se proyectan en una nueva base conforme que tiene en cuenta la relación lineal entre Y y X.</p>
<p>Ideal para el caso de tener muchas variables X, o parámetros, de los que depende la característica a controlar o variable respuesta Y.</p>
<p>CASO PRÁCTICO: se pretende controlar la eficiencia energética de las instalaciones de climatización de una oficina a partir del consumo eléctrico. En el consumo eléctrico influyen parámetros de confort térmico y calidad del aire (de hecho, dicho consumo se produce para mantener unos estándares de calidad de estos últimos).</p>
<p><strong>Procedimiento</strong></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">library</span>(pls)</a></code></pre></div>
<pre><code>## Warning: package &#39;pls&#39; was built under R version 3.6.1</code></pre>
<pre><code>## 
## Attaching package: &#39;pls&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:qualityTools&#39;:
## 
##     pcr</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     loadings</code></pre>
<p>Muestra de calibrado (se escalan previamente las varibles regresoras). La función plsr proporciona una regresión por mínimos cuadrados parciales del consumo con respecto a las demás variables (temperaturas, HR, CO2)</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">HF.pls &lt;-<span class="st"> </span><span class="kw">plsr</span>(ConTempHRco2[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">12</span>] <span class="op">~</span><span class="st"> </span><span class="kw">scale</span>(ConTempHRco2[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">12</span><span class="op">:</span><span class="dv">14</span>)]),</a>
<a class="sourceLine" id="cb93-2" title="2">               <span class="dt">ncomp =</span> <span class="dv">9</span>, <span class="dt">validation =</span> <span class="st">&quot;CV&quot;</span>)</a>
<a class="sourceLine" id="cb93-3" title="3"></a>
<a class="sourceLine" id="cb93-4" title="4"><span class="co"># Muestra de monitorizado. Se proyectan las nuevas observaciones (vectores de características) en la nueva base:</span></a>
<a class="sourceLine" id="cb93-5" title="5"></a>
<a class="sourceLine" id="cb93-6" title="6">tst.scores=<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb93-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">21</span><span class="op">:</span><span class="dv">45</span>){</a>
<a class="sourceLine" id="cb93-8" title="8">Xtst &lt;-<span class="st"> </span><span class="kw">scale</span>(ConTempHRco2[i,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">12</span><span class="op">:</span><span class="dv">14</span>)],</a>
<a class="sourceLine" id="cb93-9" title="9">              <span class="dt">center =</span> <span class="kw">colMeans</span>(ConTempHRco2[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">12</span><span class="op">:</span><span class="dv">14</span>)]),</a>
<a class="sourceLine" id="cb93-10" title="10">              <span class="dt">scale =</span> <span class="kw">apply</span>(ConTempHRco2[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">12</span><span class="op">:</span><span class="dv">14</span>)],<span class="dv">2</span>,sd))</a>
<a class="sourceLine" id="cb93-11" title="11">tst.scores &lt;-<span class="st"> </span><span class="kw">rbind</span>(tst.scores,<span class="kw">as.data.frame</span>(Xtst <span class="op">%*%</span><span class="st"> </span>HF.pls<span class="op">$</span>projection))</a>
<a class="sourceLine" id="cb93-12" title="12"></a>
<a class="sourceLine" id="cb93-13" title="13">}</a></code></pre></div>
<p><strong>T^2 de Hotelling</strong></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">qPLS=<span class="kw">mqcc</span>(<span class="kw">scores</span>(HF.pls)[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],<span class="dt">newdata=</span>tst.scores[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;T2&quot;</span>),<span class="dt">pred.limits =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-19-1.png" width="672" />
Se percibe que el proceso se empieza a descontrolar a partir de la 6ª observación de la muestra de monitorizado.
Mucho antes que empleando componentes principales</p>
<p>Uso de MEWMA aplicado a las componentes PLS:</p>
<p><strong>MEWMA</strong></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co"># Muestra de calibrado:</span></a>
<a class="sourceLine" id="cb95-2" title="2">data.mqcd &lt;-<span class="st"> </span><span class="kw">mqcd</span>(<span class="kw">scores</span>(HF.pls)[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb95-3" title="3">res.mqcs &lt;-<span class="st"> </span><span class="kw">mqcs.mewma</span>(data.mqcd)</a>
<a class="sourceLine" id="cb95-4" title="4"><span class="kw">summary</span>(res.mqcs)</a></code></pre></div>
<pre><code>## 
## Summary of group statistics:
##        V1        
##  Min.   :0.6024  
##  1st Qu.:2.1523  
##  Median :2.6653  
##  Mean   :3.0572  
##  3rd Qu.:4.0983  
##  Max.   :7.6691  
## 
## Number of quality characteristics:  2
## Number of samples or observations:  20
## Number of observations or sample size:  1
## 
## Mean Vector: 
##  -4.440892e-17 4.440892e-17
## Covariance Matrix:
##            Comp 1       Comp 2
## [1,] 4.202442e+00 1.168656e-16
## [2,] 1.168656e-16 1.295468e+00
## 
## Control limits: 
##    lcl    ucl 
## 0.0000 8.6336 
## 
## Number beyond limits: 0</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw">plot</span>(res.mqcs, <span class="dt">title =</span><span class="st">&quot; MEWMA Control Chart for Water and Solids in Jet Fuel&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="co"># Muestra de monitorizado:</span></a>
<a class="sourceLine" id="cb98-2" title="2">data.mqcd.new &lt;-<span class="st"> </span><span class="kw">mqcd</span>(tst.scores[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb98-3" title="3"></a>
<a class="sourceLine" id="cb98-4" title="4"><span class="co"># Se toman el vector de medias y la matriz de covarianzas de la muestra de calibrado</span></a>
<a class="sourceLine" id="cb98-5" title="5">Xmv=<span class="kw">matrix</span>(res.mqcs<span class="op">$</span>mean,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb98-6" title="6">S =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(res.mqcs<span class="op">$</span>S,<span class="dt">byrow=</span><span class="ot">FALSE</span>,<span class="dt">nc=</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb98-7" title="7"></a>
<a class="sourceLine" id="cb98-8" title="8"><span class="co"># Se calcula el nuevo gráfico con los límites obtenidos en la muestra de calibrado:</span></a>
<a class="sourceLine" id="cb98-9" title="9">res.mqcs.new &lt;-<span class="st"> </span><span class="kw">mqcs.mewma</span>(data.mqcd.new,<span class="dt">Xmv=</span>Xmv,<span class="dt">S=</span>S)</a>
<a class="sourceLine" id="cb98-10" title="10"><span class="kw">plot</span>(res.mqcs.new, <span class="dt">title =</span><span class="st">&quot; MEWMA Control Chart for Thermal confort and Air quality&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-20-2.png" width="672" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">names</span>(res.mqcs.new);res.mqcs.new<span class="op">$</span>violations</a></code></pre></div>
<pre><code>## [1] &quot;mqcd&quot;       &quot;type&quot;       &quot;statistics&quot; &quot;mean&quot;       &quot;S&quot;         
## [6] &quot;lambda&quot;     &quot;limits&quot;     &quot;data.name&quot;  &quot;violations&quot;</code></pre>
<pre><code>##  [1]  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
## [24] 25</code></pre>
<p>Nos damos cuenta del desplazamiento al fuera de control en la 2ª observación de la muestra de monitorizado (con PCA nos dábamos cuenta en la 4ª).</p>
</div>
</div>
<div id="control-de-calidad-de-variables-autocorreladas" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Control de Calidad de variables autocorreladas</h3>
<div id="oficinas" class="section level4">
<h4><span class="header-section-number">5.1.2.1</span> Caso práctico: Control del confort climático en oficinas.</h4>
<p>DATOS: Variables de confort térmico, calidad del aire y consumo energético en horas de ocupación (11 horas) de una oficina. Medidas horarias de septiembre y octubre.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">MultivarianteOCUP=<span class="kw">read.table</span>(<span class="st">&quot;clima.txt&quot;</span>,<span class="dt">header=</span>T)</a>
<a class="sourceLine" id="cb102-2" title="2"></a>
<a class="sourceLine" id="cb102-3" title="3">MultivarianteOCUP</a></code></pre></div>
<pre><code>##          Fecha  Hora TempFondo TempEntrada TempMedio CO2Fondo CO2Medio
## 1   09/01/2014  9:00     26.18       27.28     27.99   477.24   510.62
## 2   09/01/2014 10:00     25.45       25.78     27.18   670.39   722.58
## 3   09/01/2014 11:00     25.46       25.68     26.89   745.01   795.05
## 4   09/01/2014 12:00     26.61       27.39     27.71   742.20   796.13
## 5   09/01/2014 13:00     27.31       28.23     28.26   522.25   558.03
## 6   09/01/2014 14:00     27.28       27.98     27.93   552.22   537.57
## 7   09/01/2014 15:00     26.59       27.40     27.19   503.00   501.66
## 8   09/01/2014 16:00     26.51       27.25     26.98   695.73   711.46
## 9   09/01/2014 17:00     26.86       27.55     27.18   860.26   838.58
## 10  09/01/2014 18:00     27.25       27.91     27.48   712.04   672.56
## 11  09/01/2014 19:00     27.54       28.12     27.62   575.64   571.13
## 12  09/02/2014  9:00     27.20       28.13     28.75   459.42   527.75
## 13  09/02/2014 10:00     26.37       26.85     28.07   605.24   680.10
## 14  09/02/2014 11:00     25.98       26.52     27.47   684.97   753.85
## 15  09/02/2014 12:00     25.97       26.62     27.22   714.97   704.60
## 16  09/02/2014 13:00     25.96       26.83     27.00   645.55   613.17
## 17  09/02/2014 14:00     26.45       26.74     27.05   486.38   488.14
## 18  09/02/2014 15:00     26.71       27.29     27.16   461.62   457.62
## 19  09/02/2014 16:00     27.37       27.89     27.45   444.60   448.91
## 20  09/02/2014 17:00     28.02       28.46     27.85   501.95   491.99
## 21  09/02/2014 18:00     28.26       28.35     27.83   718.85   757.35
## 22  09/02/2014 19:00     28.64       28.45     28.03   754.94   799.12
## 23  09/03/2014  9:00     28.10       28.73     29.54   462.03   515.88
## 24  09/03/2014 10:00     27.16       27.50     28.49   620.29   665.53
## 25  09/03/2014 11:00     26.92       26.92     28.05   706.31   743.54
## 26  09/03/2014 12:00     27.09       27.21     27.98   707.80   776.27
## 27  09/03/2014 13:00     26.94       27.12     27.88   772.34   842.56
## 28  09/03/2014 14:00     27.06       27.02     27.76   749.19   811.60
## 29  09/03/2014 15:00     26.99       27.07     27.64   681.65   754.31
## 30  09/03/2014 16:00     27.01       27.08     27.52   695.22   764.81
## 31  09/03/2014 17:00     27.07       27.00     27.64   807.22   860.97
## 32  09/03/2014 18:00     27.03       27.09     27.77   782.57   811.15
## 33  09/03/2014 19:00     27.06       26.84     27.80   895.90   967.09
## 34  09/04/2014  9:00     26.71       27.35     28.15   462.55   534.56
## 35  09/04/2014 10:00     26.86       27.11     27.97   597.54   661.44
## 36  09/04/2014 11:00     26.95       26.70     27.70   744.99   791.76
## 37  09/04/2014 12:00     26.87       26.44     27.54   744.47   804.13
## 38  09/04/2014 13:00     26.93       26.70     27.53   737.73   769.05
## 39  09/04/2014 14:00     26.98       26.56     27.36   803.17   807.60
## 40  09/04/2014 15:00     26.92       26.42     27.35   743.58   728.49
## 41  09/04/2014 16:00     26.92       26.69     27.45   704.69   735.01
## 42  09/04/2014 17:00     27.05       26.75     27.60   731.31   728.24
## 43  09/04/2014 18:00     27.62       27.33     27.87   816.31   832.39
## 44  09/04/2014 19:00     26.91       26.16     27.39   881.26   917.41
## 45  09/05/2014  9:00     25.17       25.45     26.50   495.35   546.83
## 46  09/05/2014 10:00     24.92       24.84     26.00   756.82   826.19
## 47  09/05/2014 11:00     24.96       24.92     25.87   860.36   901.46
## 48  09/05/2014 12:00     24.96       25.01     25.87   927.98   995.70
## 49  09/05/2014 13:00     25.71       25.79     26.28   859.22   912.38
## 50  09/05/2014 14:00     26.74       26.79     26.81   813.34   839.57
## 51  09/05/2014 15:00     27.41       27.42     27.31   786.12   793.28
## 52  09/05/2014 16:00     27.89       27.95     27.57   657.55   686.55
## 53  09/05/2014 17:00     27.17       27.16     26.94   706.49   716.71
## 54  09/05/2014 18:00     26.94       26.80     26.75   687.72   694.84
## 55  09/05/2014 19:00     26.89       26.57     26.68   709.57   711.69
## 56  09/08/2014  9:00     24.36       25.02     25.64   460.12   517.67
## 57  09/08/2014 10:00     24.87       25.14     25.88   703.38   805.53
## 58  09/08/2014 11:00     24.90       24.82     25.70   784.84   877.58
## 59  09/08/2014 12:00     24.97       24.54     25.50   801.38   834.99
## 60  09/08/2014 13:00     25.64       25.51     25.92   702.24   788.97
## 61  09/08/2014 14:00     25.91       25.47     25.96   674.69   721.24
## 62  09/08/2014 15:00     25.95       25.58     25.75   431.03   487.52
## 63  09/08/2014 16:00     26.00       25.79     25.72   512.39   488.21
## 64  09/08/2014 17:00     26.05       25.96     25.60   829.11   844.11
## 65  09/08/2014 18:00     26.20       26.25     25.63   924.40   960.09
## 66  09/08/2014 19:00     26.55       26.38     25.86   896.16   911.05
## 67  09/09/2014  9:00     25.59       26.52     27.07   431.72   502.94
## 68  09/09/2014 10:00     25.94       26.61     26.99   523.20   611.46
## 69  09/09/2014 11:00     25.97       26.09     26.66   600.34   660.74
## 70  09/09/2014 12:00     25.92       25.94     26.45   681.71   722.56
## 71  09/09/2014 13:00     26.18       26.40     26.60   682.19   720.17
## 72  09/09/2014 14:00     26.98       27.26     27.02   634.75   658.01
## 73  09/09/2014 15:00     26.95       27.43     26.96   619.99   644.95
## 74  09/09/2014 16:00     27.01       27.55     26.98   674.77   664.06
## 75  09/09/2014 17:00     27.06       27.62     26.99   692.64   679.65
## 76  09/09/2014 18:00     27.01       27.27     26.79   718.42   712.85
## 77  09/09/2014 19:00     27.00       27.10     26.69   682.86   712.98
## 78  09/10/2014  9:00     26.13       26.84     27.42   435.67   551.91
## 79  09/10/2014 10:00     26.58       26.98     27.59   589.10   721.99
## 80  09/10/2014 11:00     25.99       25.77     26.95   754.66   850.61
## 81  09/10/2014 12:00     25.80       25.88     26.65   827.29   894.27
## 82  09/10/2014 13:00     26.96       27.38     27.22   727.32   836.88
## 83  09/10/2014 14:00     27.02       27.09     27.02   855.89   910.07
## 84  09/10/2014 15:00     26.96       27.33     27.07   690.21   722.88
## 85  09/10/2014 16:00     26.97       27.40     27.09   645.70   683.00
## 86  09/10/2014 17:00     27.01       27.37     27.01   865.36   903.05
## 87  09/10/2014 18:00     27.04       26.90     26.93   948.94  1033.97
## 88  09/10/2014 19:00     27.14       27.37     27.12   952.38  1023.16
## 89  09/11/2014  9:00     26.46       27.33     27.96   421.03   500.77
## 90  09/11/2014 10:00     26.90       27.61     28.15   529.24   629.65
## 91  09/11/2014 11:00     26.81       27.20     27.88   603.35   683.70
## 92  09/11/2014 12:00     26.98       27.15     27.67   722.89   756.83
## 93  09/11/2014 13:00     26.97       27.11     27.53   728.26   772.57
## 94  09/11/2014 14:00     27.00       27.21     27.26   745.30   784.00
## 95  09/11/2014 15:00     26.94       27.32     27.28   704.08   762.49
## 96  09/11/2014 16:00     27.02       27.59     27.30   698.64   764.80
## 97  09/11/2014 17:00     27.21       27.75     27.57   810.89   844.30
## 98  09/11/2014 18:00     27.19       27.49     27.57   767.27   791.23
## 99  09/11/2014 19:00     27.25       27.26     27.48   831.17   887.27
## 100 09/12/2014  9:00     26.76       27.71     28.40   402.12   499.26
## 101 09/12/2014 10:00     26.94       27.60     28.26   523.45   609.56
## 102 09/12/2014 11:00     26.93       27.45     27.94   593.63   670.38
## 103 09/12/2014 12:00     26.99       27.41     27.79   705.94   777.57
## 104 09/12/2014 13:00     26.96       27.29     27.51   693.92   744.34
## 105 09/12/2014 14:00     27.04       27.37     27.36   634.62   685.17
## 106 09/12/2014 15:00     26.91       27.36     27.28   539.53   614.38
## 107 09/12/2014 16:00     27.00       27.34     27.36   652.07   704.83
## 108 09/12/2014 17:00     27.03       26.82     27.32   762.41   831.53
## 109 09/12/2014 18:00     27.02       26.45     27.21   817.40   885.80
## 110 09/12/2014 19:00     26.99       26.21     27.28   765.98   832.58
## 111 15/09/2014  9:00     25.73       26.79     27.50   382.95   472.63
## 112 15/09/2014 10:00     26.20       27.35     27.71   440.13   596.01
## 113 15/09/2014 11:00     26.68       27.66     27.78   476.62   639.77
## 114 15/09/2014 12:00     26.93       27.80     27.77   555.23   666.30
## 115 15/09/2014 13:00     26.91       27.53     27.49   696.95   754.69
## 116 15/09/2014 14:00     26.92       27.20     27.04   705.32   738.54
## 117 15/09/2014 15:00     26.88       27.30     27.11   600.08   655.10
## 118 15/09/2014 16:00     26.93       27.14     27.02   705.88   737.19
## 119 15/09/2014 17:00     27.03       27.11     26.94   762.97   799.46
## 120 15/09/2014 18:00     26.96       26.83     26.53   713.34   771.00
## 121 15/09/2014 19:00     27.01       26.39     26.69   629.00   700.72
## 122 16/09/2014  9:00     25.33       26.02     26.82   358.26   439.85
## 123 16/09/2014 10:00     25.86       26.34     26.95   509.64   670.74
## 124 16/09/2014 11:00     26.58       27.13     27.23   663.17   880.27
## 125 16/09/2014 12:00     26.90       27.61     27.39   628.61   825.56
## 126 16/09/2014 13:00     26.88       27.50     27.21   624.96   745.92
## 127 16/09/2014 14:00     26.98       27.27     26.96   776.38   845.15
## 128 16/09/2014 15:00     26.93       27.23     26.96   710.91   743.90
## 129 16/09/2014 16:00     26.97       27.03     26.83   710.36   763.49
## 130 16/09/2014 17:00     27.04       26.92     26.80   747.53   798.03
## 131 16/09/2014 18:00     26.93       26.62     26.64   856.86   919.35
## 132 16/09/2014 19:00     26.91       26.35     26.70   816.20   883.30
## 133 17/09/2014  9:00     25.32       26.15     26.74   399.56   498.66
## 134 17/09/2014 10:00     25.66       26.05     26.23   489.65   581.38
## 135 17/09/2014 11:00     26.25       26.37     26.52   542.90   606.90
## 136 17/09/2014 12:00     26.84       26.98     26.92   641.70   744.74
## 137 17/09/2014 13:00     26.98       26.95     26.89   728.46   819.60
## 138 17/09/2014 14:00     26.88       26.62     26.76   735.89   825.91
## 139 17/09/2014 15:00     26.91       26.94     26.71   665.33   745.07
## 140 17/09/2014 16:00     26.92       26.92     26.58   623.32   715.09
## 141 17/09/2014 17:00     26.98       26.58     26.52   717.85   802.15
## 142 17/09/2014 18:00     26.94       26.47     26.52   796.81   857.71
## 143 17/09/2014 19:00     26.97       26.73     26.48   694.49   769.67
## 144 18/09/2014  9:00     24.82       25.74     26.32   348.52   465.42
## 145 18/09/2014 10:00     25.43       26.02     26.42   502.31   648.71
## 146 18/09/2014 11:00     26.01       26.40     26.68   532.70   694.31
## 147 18/09/2014 12:00     26.36       26.70     26.86   547.32   721.19
## 148 18/09/2014 13:00     26.71       27.11     27.00   612.97   717.79
## 149 18/09/2014 14:00     26.84       27.19     26.96   595.86   716.53
## 150 18/09/2014 15:00     26.80       27.11     26.85   585.52   725.60
## 151 18/09/2014 16:00     26.86       27.00     26.77   626.76   730.58
## 152 18/09/2014 17:00     27.03       26.89     26.88   630.56   779.37
## 153 18/09/2014 18:00     26.93       26.48     26.84   736.73   842.66
## 154 18/09/2014 19:00     26.85       26.33     26.84   709.84   806.25
## 155 19/09/2014  9:00     24.31       25.09     25.68   357.56   484.00
## 156 19/09/2014 10:00     25.04       25.59     25.89   511.01   667.43
## 157 19/09/2014 11:00     25.79       26.13     26.28   636.47   745.70
## 158 19/09/2014 12:00     26.34       26.44     26.49   674.80   690.83
## 159 19/09/2014 13:00     26.67       26.50     26.50   625.84   643.13
## 160 19/09/2014 14:00     26.75       26.44     26.50   624.29   631.82
## 161 19/09/2014 15:00     26.69       26.43     26.51   495.41   571.61
## 162 19/09/2014 16:00     26.89       26.62     26.71   625.07   709.74
## 163 19/09/2014 17:00     26.86       26.32     26.39   666.98   722.08
## 164 19/09/2014 18:00     26.89       26.10     26.42   657.63   737.15
## 165 19/09/2014 19:00     26.79       26.42     26.74   588.73   676.90
## 166 22/09/2014  9:00     24.62       25.49     25.84   412.75   475.98
## 167 22/09/2014 10:00     25.30       25.86     26.07   413.80   538.63
## 168 22/09/2014 11:00     25.81       25.94     26.12   395.81   539.77
## 169 22/09/2014 12:00     26.25       26.50     26.49   435.69   595.82
## 170 22/09/2014 13:00     26.78       26.89     26.78   423.03   597.77
## 171 22/09/2014 14:00     26.91       26.95     26.78   435.33   546.56
## 172 22/09/2014 15:00     26.94       26.73     26.46   373.30   472.68
## 173 22/09/2014 16:00     26.98       26.25     26.27   381.78   472.60
## 174 22/09/2014 17:00     26.87       26.20     26.36   395.72   490.51
## 175 22/09/2014 18:00     26.91       25.91     26.19   399.61   488.45
## 176 22/09/2014 19:00     26.86       25.90     26.31   420.42   501.58
## 177 23/09/2014  9:00     24.61       25.43     25.92   355.83   454.01
## 178 23/09/2014 10:00     25.14       25.40     25.86   402.49   509.85
## 179 23/09/2014 11:00     25.55       25.45     25.88   404.51   525.27
## 180 23/09/2014 12:00     25.93       25.76     26.10   406.23   531.28
## 181 23/09/2014 13:00     26.11       26.07     26.27   409.60   521.62
## 182 23/09/2014 14:00     26.43       26.41     26.63   483.39   610.05
## 183 23/09/2014 15:00     26.57       26.65     26.76   471.12   592.27
## 184 23/09/2014 16:00     26.79       26.88     26.74   477.49   589.84
## 185 23/09/2014 17:00     26.90       26.73     26.58   482.34   613.83
## 186 23/09/2014 18:00     26.88       26.24     26.39   454.90   565.48
## 187 23/09/2014 19:00     26.83       26.34     26.43   456.11   534.54
## 188 24/09/2014  9:00     23.52       24.37     24.95   468.99   537.96
## 189 24/09/2014 10:00     24.00       24.67     25.17   667.48   805.79
## 190 24/09/2014 11:00     24.54       25.05     25.08   752.67   849.45
## 191 24/09/2014 12:00     24.95       25.46     25.31   718.32   809.54
## 192 24/09/2014 13:00     25.31       25.54     25.51   410.66   583.93
## 193 24/09/2014 14:00     25.61       25.74     25.39   387.04   517.33
## 194 24/09/2014 15:00     26.15       26.61     25.93   395.38   548.63
## 195 24/09/2014 16:00     26.82       27.16     26.36   403.43   544.33
## 196 24/09/2014 17:00     27.07       27.32     26.52   424.95   537.22
## 197 24/09/2014 18:00     26.93       26.99     26.21   436.21   535.74
## 198 24/09/2014 19:00     26.91       27.19     26.41   462.83   550.27
## 199 25/09/2014  9:00     23.21       24.55     24.89   447.34   536.64
## 200 25/09/2014 10:00     23.52       24.78     24.81   688.21   764.32
## 201 25/09/2014 11:00     24.00       25.13     25.01   744.57   809.96
## 202 25/09/2014 12:00     24.49       25.52     25.31   768.32   879.65
## 203 25/09/2014 13:00     24.96       25.89     25.45   746.00   818.49
## 204 25/09/2014 14:00     25.46       26.18     25.61   521.79   655.51
## 205 25/09/2014 15:00     26.02       26.87     25.91   446.45   646.74
## 206 25/09/2014 16:00     26.77       27.77     26.41   643.33   808.80
## 207 25/09/2014 17:00     26.92       27.82     26.59   540.22   667.95
## 208 25/09/2014 18:00     27.00       27.16     26.16   530.23   582.84
## 209 25/09/2014 19:00     26.88       26.16     25.48   409.65   482.58
## 210 26/09/2014  9:00     23.21       24.48     24.77   408.91   503.04
## 211 26/09/2014 10:00     23.62       24.90     25.04   567.52   692.96
## 212 26/09/2014 11:00     24.15       25.30     25.29   642.82   763.08
## 213 26/09/2014 12:00     24.65       25.76     25.55   611.95   742.91
## 214 26/09/2014 13:00     25.70       26.75     26.24   622.49   763.37
## 215 26/09/2014 14:00     26.44       27.18     26.56   555.11   662.53
## 216 26/09/2014 15:00     26.88       27.39     26.61   417.21   518.22
## 217 26/09/2014 16:00     27.45       27.92     27.04   424.69   463.06
## 218 26/09/2014 17:00     26.82       27.66     26.69   667.21   555.24
## 219 26/09/2014 18:00     26.50       27.31     26.40   660.01   570.07
## 220 26/09/2014 19:00     26.86       27.40     26.60   459.07   505.60
## 221 29/09/2014  9:00     23.57       24.62     24.69   445.08   529.72
## 222 29/09/2014 10:00     24.17       25.15     24.92   696.60   790.57
## 223 29/09/2014 11:00     24.81       25.60     25.48   701.06   804.22
## 224 29/09/2014 12:00     25.12       25.72     25.49   700.99   754.36
## 225 29/09/2014 13:00     25.54       26.07     25.77   716.45   745.54
## 226 29/09/2014 14:00     25.88       26.45     25.92   700.18   720.52
## 227 29/09/2014 15:00     25.91       26.71     25.93   618.18   669.80
## 228 29/09/2014 16:00     26.00       26.95     26.00   603.54   684.47
## 229 29/09/2014 17:00     25.98       26.45     25.80   759.27   757.98
## 230 29/09/2014 18:00     26.02       26.65     25.94   795.22   763.14
## 231 29/09/2014 19:00     25.98       26.38     25.81   840.45   802.63
## 232 30/09/2014  9:00     23.46       24.64     24.88   492.39   538.25
## 233 30/09/2014 10:00     23.89       25.00     25.05   666.35   704.79
## 234 30/09/2014 11:00     24.34       25.43     25.40   714.81   781.27
## 235 30/09/2014 12:00     24.82       25.79     25.50   715.07   776.53
## 236 30/09/2014 13:00     25.34       26.11     25.64   728.49   771.66
## 237 30/09/2014 14:00     25.88       26.49     26.00   532.66   664.55
## 238 30/09/2014 15:00     25.91       26.82     25.87   551.24   619.00
## 239 30/09/2014 16:00     25.93       26.98     25.77   618.94   610.72
## 240 30/09/2014 17:00     25.93       27.04     25.84   702.94   715.24
## 241 30/09/2014 18:00     25.99       26.82     25.96   786.66   747.95
## 242 30/09/2014 19:00     25.92       26.51     25.91   682.04   670.89
## 243 10/01/2014  9:00     23.93       24.95     24.70   744.16   814.27
## 244 10/01/2014 10:00     24.40       25.34     25.08   737.65   863.61
## 245 10/01/2014 11:00     24.92       25.71     25.50   792.33   895.48
## 246 10/01/2014 12:00     25.48       26.01     25.73   779.67   866.63
## 247 10/01/2014 13:00     25.90       26.44     25.86   750.83   806.07
## 248 10/01/2014 14:00     25.92       26.96     25.89   622.20   699.21
## 249 10/01/2014 15:00     26.07       27.11     25.93   720.24   732.66
## 250 10/01/2014 16:00     25.95       26.86     25.64   625.87   633.75
## 251 10/01/2014 17:00     26.23       27.09     26.08   523.47   510.53
## 252 10/01/2014 18:00     26.45       26.92     26.08   430.88   467.99
## 253 10/01/2014 19:00     27.41       27.36     26.56   387.61   453.31
## 254 10/02/2014  9:00     24.45       25.38     25.61   652.09   767.06
## 255 10/02/2014 10:00     24.91       25.91     26.03   643.10   768.55
## 256 10/02/2014 11:00     25.30       26.45     26.22   559.84   722.13
## 257 10/02/2014 12:00     25.84       26.78     26.35   620.44   713.97
## 258 10/02/2014 13:00     25.95       26.54     26.04   544.60   580.42
## 259 10/02/2014 14:00     25.93       26.75     25.92   474.85   494.86
## 260 10/02/2014 15:00     26.09       27.06     26.10   543.17   502.94
## 261 10/02/2014 16:00     26.14       27.10     26.09   664.82   530.26
## 262 10/02/2014 17:00     26.39       27.21     26.16   726.85   570.75
## 263 10/02/2014 18:00     26.38       27.08     26.21   585.38   545.06
## 264 10/02/2014 19:00     26.41       27.08     26.29   470.64   480.15
## 265 10/03/2014  9:00     24.94       25.88     26.16   644.37   802.34
## 266 10/03/2014 10:00     25.54       26.41     26.26   777.52   878.68
## 267 10/03/2014 11:00     25.98       26.93     26.52   741.85   880.97
## 268 10/03/2014 12:00     25.92       26.55     26.29   849.57   835.74
## 269 10/03/2014 13:00     25.93       26.61     26.04   705.21   729.57
## 270 10/03/2014 14:00     26.02       26.97     26.13   592.21   631.99
## 271 10/03/2014 15:00     26.10       27.07     26.25   666.00   652.38
## 272 10/03/2014 16:00     26.21       27.12     26.26   804.34   787.18
## 273 10/03/2014 17:00     26.39       27.02     26.18   881.72   882.16
## 274 10/03/2014 18:00     26.02       26.47     25.94   705.07   750.46
## 275 10/03/2014 19:00     25.93       26.46     26.08   496.97   571.05
## 276 10/06/2014  9:00     23.10       23.75     23.53   668.53   709.99
## 277 10/06/2014 10:00     23.72       24.11     23.81   713.79   738.28
## 278 10/06/2014 11:00     24.15       24.40     24.01   700.82   721.22
## 279 10/06/2014 12:00     24.44       24.62     24.17   655.26   697.64
## 280 10/06/2014 13:00     24.75       24.83     24.47   649.95   715.72
## 281 10/06/2014 14:00     24.83       24.95     24.69   566.41   664.44
## 282 10/06/2014 15:00     24.82       24.60     24.47   578.71   644.75
## 283 10/06/2014 16:00     24.98       24.46     24.50   563.11   667.39
## 284 10/06/2014 17:00     25.08       24.64     24.60   585.62   631.30
## 285 10/06/2014 18:00     25.18       25.03     24.89   588.46   632.13
## 286 10/06/2014 19:00     24.84       25.05     24.90   468.85   536.71
## 287 10/07/2014  9:00     22.68       23.16     22.94   638.99   702.64
## 288 10/07/2014 10:00     23.25       23.55     23.18   693.25   765.72
## 289 10/07/2014 11:00     23.79       23.95     23.59   708.52   805.71
## 290 10/07/2014 12:00     24.41       24.43     24.15   773.01   862.70
## 291 10/07/2014 13:00     24.78       24.64     24.38   780.81   876.63
## 292 10/07/2014 14:00     24.79       24.57     24.12   593.88   601.25
## 293 10/07/2014 15:00     24.94       24.80     24.38   599.35   690.57
## 294 10/07/2014 16:00     25.26       25.09     24.70   676.27   749.77
## 295 10/07/2014 17:00     25.61       25.20     25.02   735.54   824.16
## 296 10/07/2014 18:00     25.67       25.23     25.16   745.34   787.08
## 297 10/07/2014 19:00     25.18       25.14     25.04   605.12   676.59
## 298 10/08/2014  9:00     23.51       23.80     24.01   597.84   691.58
## 299 10/08/2014 10:00     24.16       24.11     24.16   769.70   847.23
## 300 10/08/2014 11:00     24.63       24.39     24.39   732.68   842.39
## 301 10/08/2014 12:00     24.86       24.54     24.55   708.09   794.89
## 302 10/08/2014 13:00     25.05       24.69     24.86   725.24   830.83
## 303 10/08/2014 14:00     24.91       24.67     24.55   640.60   775.60
## 304 10/08/2014 15:00     24.86       24.68     24.42   610.54   740.51
## 305 10/08/2014 16:00     25.05       24.94     24.74   691.26   812.93
## 306 10/08/2014 17:00     25.20       25.08     25.04   731.54   784.25
## 307 10/08/2014 18:00     25.08       24.98     24.95   659.93   708.77
## 308 10/08/2014 19:00     24.52       24.71     24.78   493.39   593.23
## 309 10/09/2014  9:00     22.14       22.64     22.57   656.68   723.25
## 310 10/09/2014 10:00     22.81       23.08     23.18   722.59   780.44
## 311 10/09/2014 11:00     23.18       23.30     23.30   737.91   824.48
## 312 10/09/2014 12:00     23.66       23.70     23.72   810.26   866.82
## 313 10/09/2014 13:00     23.91       23.84     23.77   768.27   792.81
## 314 10/09/2014 14:00     23.84       23.91     23.71   673.50   759.85
## 315 10/09/2014 15:00     24.31       24.68     24.04   740.71   786.78
## 316 10/09/2014 16:00     24.86       25.48     24.71   564.47   734.21
## 317 10/09/2014 17:00     24.97       25.18     24.68   624.03   790.39
## 318 10/09/2014 18:00     24.66       24.82     24.54   609.89   689.93
## 319 10/09/2014 19:00     24.22       24.54     24.30   491.05   567.70
## 320 10/10/2014  9:00     21.51       22.31     22.44   581.57   681.56
## 321 10/10/2014 10:00     22.02       22.83     22.87   727.97   829.87
## 322 10/10/2014 11:00     22.68       23.21     23.07   832.81   886.63
## 323 10/10/2014 12:00     23.37       23.79     22.94   821.65   953.03
## 324 10/10/2014 13:00     24.06       24.38     22.75   851.89   962.75
## 325 10/10/2014 14:00     24.25       24.41     22.76   637.77   778.18
## 326 10/10/2014 15:00     24.34       24.47     22.85   543.51   684.75
## 327 10/10/2014 16:00     25.03       25.23     23.49   780.19   919.88
## 328 10/10/2014 17:00     25.40       25.18     23.80   771.33   848.91
## 329 10/10/2014 18:00     25.08       24.85     23.80   634.76   667.28
## 330 10/10/2014 19:00     24.53       24.55     23.46   561.90   600.03
## 331 13/10/2014  9:00     21.65       22.04     21.21   636.87   832.73
## 332 13/10/2014 10:00     22.29       22.51     21.62   840.42  1040.71
## 333 13/10/2014 11:00     22.80       23.02     22.01   774.54  1004.19
## 334 13/10/2014 12:00     23.18       23.20     22.06   925.70   982.69
## 335 13/10/2014 13:00     23.58       23.47     22.33   763.66   929.14
## 336 13/10/2014 14:00     23.56       23.62     22.41   673.66   844.20
## 337 13/10/2014 15:00     23.70       23.66     22.43   763.69   953.32
## 338 13/10/2014 16:00     24.08       23.82     22.68   801.92  1006.38
## 339 13/10/2014 17:00     24.23       23.97     22.92   600.64   732.70
## 340 13/10/2014 18:00     24.16       23.71     22.87   627.31   667.50
## 341 13/10/2014 19:00     23.64       23.62     22.76   690.92   771.35
## 342 14/10/2014  9:00     22.06       22.56     21.41   744.09   759.06
## 343 14/10/2014 10:00     22.93       23.22     22.12   713.65   828.47
## 344 14/10/2014 11:00     23.18       23.35     22.20   701.28   875.40
## 345 14/10/2014 12:00     23.31       23.18     21.87   889.95   929.41
## 346 14/10/2014 13:00     23.55       23.52     21.78   830.12   835.79
## 347 14/10/2014 14:00     23.72       23.99     21.93   641.08   721.31
## 348 14/10/2014 15:00     24.14       24.34     22.32   689.82   726.23
## 349 14/10/2014 16:00     24.65       24.76     22.75   687.96   741.54
## 350 14/10/2014 17:00     25.22       25.20     23.18   799.97   847.24
## 351 14/10/2014 18:00     25.27       24.83     23.21   714.29   808.84
## 352 14/10/2014 19:00     24.64       24.19     23.04   510.65   635.16
## 353 15/10/2014  9:00     23.92       24.31     23.41   468.04   599.76
## 354 15/10/2014 10:00     24.27       24.47     23.44   617.11   803.77
## 355 15/10/2014 11:00     24.66       24.60     23.55   673.62   882.90
## 356 15/10/2014 12:00     25.00       24.61     23.57   812.06   977.93
## 357 15/10/2014 13:00     25.18       24.67     23.69   685.55   847.11
## 358 15/10/2014 14:00     25.21       24.93     23.90   610.46   763.63
## 359 15/10/2014 15:00     25.60       25.32     23.91   765.47   920.08
## 360 15/10/2014 16:00     25.99       25.48     24.09   821.61   978.99
## 361 15/10/2014 17:00     26.06       25.47     24.09   693.57   836.27
## 362 15/10/2014 18:00     26.15       25.70     24.44   677.77   772.19
## 363 15/10/2014 19:00     25.58       25.25     24.38   536.04   686.81
## 364 16/10/2014  9:00     24.16       24.55     23.73   513.43   713.81
## 365 16/10/2014 10:00     24.53       24.75     23.88   573.06   767.39
## 366 16/10/2014 11:00     24.74       24.82     23.86   582.59   775.38
## 367 16/10/2014 12:00     25.02       24.87     23.86   761.46   912.74
## 368 16/10/2014 13:00     25.20       25.05     24.10   525.31   702.53
## 369 16/10/2014 14:00     25.03       24.98     23.97   522.03   650.52
## 370 16/10/2014 15:00     25.14       25.08     24.06   568.75   771.32
## 371 16/10/2014 16:00     25.36       25.11     24.23   552.40   720.67
## 372 16/10/2014 17:00     25.33       25.03     24.10   791.88   854.17
## 373 16/10/2014 18:00     25.35       25.31     24.25   647.54   840.62
## 374 16/10/2014 19:00     25.01       25.24     24.06   657.51   799.35
## 375 17/10/2014  9:00     24.63       25.14     23.98   526.87   618.74
## 376 17/10/2014 10:00     24.88       24.83     23.79   738.25   840.80
## 377 17/10/2014 11:00     25.09       24.95     23.83   811.77   887.59
## 378 17/10/2014 12:00     25.49       25.32     24.09   745.07   836.90
## 379 17/10/2014 13:00     25.84       25.74     24.29   669.69   767.97
## 380 17/10/2014 14:00     25.94       25.96     24.30   692.61   723.80
## 381 17/10/2014 15:00     26.32       26.43     24.48   693.11   723.96
## 382 17/10/2014 16:00     26.57       26.55     24.62   716.40   740.97
## 383 17/10/2014 17:00     27.07       26.96     25.03   693.01   661.30
## 384 17/10/2014 18:00     27.39       27.34     25.39   662.25   660.88
## 385 17/10/2014 19:00     27.05       27.04     25.31   505.95   568.98
## 386 20/10/2014  9:00     24.79       25.45     24.56   598.55   719.41
## 387 20/10/2014 10:00     25.14       25.50     24.56   660.62   834.41
## 388 20/10/2014 11:00     25.54       25.73     24.64   752.64   911.09
## 389 20/10/2014 12:00     26.06       26.10     24.93   778.25   859.01
## 390 20/10/2014 13:00     26.42       26.47     25.13   750.10   760.48
## 391 20/10/2014 14:00     26.81       27.28     25.47   676.60   727.36
## 392 20/10/2014 15:00     27.25       27.96     25.91   709.63   726.74
## 393 20/10/2014 16:00     26.60       27.17     25.32   924.57   811.40
## 394 20/10/2014 17:00     26.09       25.92     24.64  1066.50  1039.36
## 395 20/10/2014 18:00     25.85       25.47     24.57   945.01   950.07
## 396 20/10/2014 19:00     25.86       25.90     24.84   775.53   803.87
## 397 21/10/2014  9:00     25.44       26.04     24.99   801.18   888.49
## 398 21/10/2014 10:00     25.76       26.22     25.03   934.63   980.24
## 399 21/10/2014 11:00     26.05       26.47     25.23   945.06  1010.10
## 400 21/10/2014 12:00     26.21       26.71     25.32   942.55  1023.32
## 401 21/10/2014 13:00     25.90       26.31     24.87   964.68   981.07
## 402 21/10/2014 14:00     25.91       26.30     24.93   755.20   855.81
## 403 21/10/2014 15:00     25.79       26.10     24.81   727.79   800.16
## 404 21/10/2014 16:00     26.03       25.91     24.77   889.56  1036.29
## 405 21/10/2014 17:00     26.62       26.56     25.32   924.02  1024.22
## 406 21/10/2014 18:00     26.60       26.58     25.45   799.89   850.05
## 407 21/10/2014 19:00     26.16       26.50     25.39   665.98   741.83
## 408 22/10/2014  9:00     23.56       24.26     23.34   723.51   759.61
## 409 22/10/2014 10:00     24.00       24.56     23.47   776.57   785.34
## 410 22/10/2014 11:00     24.45       24.96     23.96   754.37   829.78
## 411 22/10/2014 12:00     24.96       25.50     24.36   800.60   893.59
## 412 22/10/2014 13:00     25.55       26.35     24.77   704.13   896.90
## 413 22/10/2014 14:00     26.17       27.29     25.27   787.68   949.38
## 414 22/10/2014 15:00     26.55       27.66     25.49   883.86   919.14
## 415 22/10/2014 16:00     25.99       26.97     24.97  1027.58   875.94
## 416 22/10/2014 17:00     25.89       26.81     24.85   877.08   749.78
## 417 22/10/2014 18:00     25.85       26.43     24.66   863.15   803.70
## 418 22/10/2014 19:00     25.38       25.41     24.33   760.16   794.23
## 419 23/10/2014  9:00     24.59       25.66     24.44   718.43   757.25
## 420 23/10/2014 10:00     24.74       25.76     24.57   736.28   824.72
## 421 23/10/2014 11:00     25.06       26.01     24.63   816.13   913.29
## 422 23/10/2014 12:00     25.50       26.47     24.90   773.04   920.98
## 423 23/10/2014 13:00     25.91       27.06     25.20   727.23   924.83
## 424 23/10/2014 14:00     25.09       26.49     24.67   834.21   848.58
## 425 23/10/2014 15:00     24.97       26.50     24.52   859.75   796.44
## 426 23/10/2014 16:00     25.02       26.42     24.43   884.69   797.61
## 427 23/10/2014 17:00     25.17       26.24     24.31  1004.44   866.39
## 428 23/10/2014 18:00     25.01       25.58     24.10  1062.64  1011.79
## 429 23/10/2014 19:00     24.95       25.34     24.22   914.16   865.98
## 430 24/10/2014  9:00     24.81       25.44     24.48   768.22   785.00
## 431 24/10/2014 10:00     25.30       25.57     24.66   864.21   850.36
## 432 24/10/2014 11:00     25.70       25.93     25.06   853.79   882.05
## 433 24/10/2014 12:00     26.14       26.62     25.42   676.04   899.61
## 434 24/10/2014 13:00     26.30       26.90     25.52   848.17   951.99
## 435 24/10/2014 14:00     25.32       25.76     24.68   937.37   938.16
## 436 24/10/2014 15:00     25.13       25.49     24.33  1028.93   994.33
## 437 24/10/2014 16:00     24.94       24.69     24.08  1110.75  1087.90
## 438 24/10/2014 17:00     24.86       24.59     24.05   939.68   942.31
## 439 24/10/2014 18:00     24.97       25.20     24.28   664.25   640.04
## 440 24/10/2014 19:00     25.20       25.50     24.58   532.03   549.08
## 441 27/10/2014  9:00     23.82       25.11     23.88   622.65   706.11
## 442 27/10/2014 10:00     24.50       25.54     24.12   731.27   783.43
## 443 27/10/2014 11:00     25.01       26.05     24.40   769.85   766.12
## 444 27/10/2014 12:00     25.71       26.72     24.82   681.68   741.17
## 445 27/10/2014 13:00     26.48       27.24     25.10   692.85   605.22
## 446 27/10/2014 14:00     26.99       27.72     25.42   528.84   559.89
## 447 27/10/2014 15:00     26.51       27.17     24.69   698.27   761.72
## 448 27/10/2014 16:00     26.30       26.84     24.73   784.44   767.96
## 449 27/10/2014 17:00     26.21       26.22     24.73   863.56   810.90
## 450 27/10/2014 18:00     26.56       26.61     25.13   836.23   826.02
## 451 27/10/2014 19:00     26.50       26.80     25.38   604.66   662.92
## 452 28/10/2014  9:00     25.58       26.36     25.23   615.95   689.41
## 453 28/10/2014 10:00     25.96       26.57     25.45   708.54   697.75
## 454 28/10/2014 11:00     26.47       27.08     25.83   628.43   711.67
## 455 28/10/2014 12:00     26.99       27.58     26.06   752.10   846.48
## 456 28/10/2014 13:00     27.64       28.39     26.57   664.05   815.05
## 457 28/10/2014 14:00     26.72       27.98     26.08   819.27   805.78
## 458 28/10/2014 15:00     26.20       27.42     25.59   868.70   841.85
## 459 28/10/2014 16:00     26.09       27.10     25.51   952.77   895.25
## 460 28/10/2014 17:00     26.06       26.81     25.32   986.21   994.19
## 461 28/10/2014 18:00     25.74       25.66     24.92   827.47   864.26
## 462 28/10/2014 19:00     25.01       24.90     24.56   677.21   684.16
## 463 29/10/2014  9:00     24.87       25.92     24.83   690.98   807.93
## 464 29/10/2014 10:00     24.93       25.93     24.70   835.00   870.31
## 465 29/10/2014 11:00     24.89       25.78     24.58   761.79   795.12
## 466 29/10/2014 12:00     24.86       25.80     24.54   681.34   734.59
## 467 29/10/2014 13:00     24.94       25.76     24.37   779.30   770.72
## 468 29/10/2014 14:00     25.37       26.27     24.65   548.35   646.09
## 469 29/10/2014 15:00     25.94       27.17     25.09   760.11   736.29
## 470 29/10/2014 16:00     25.96       27.01     24.99  1006.56   982.25
## 471 29/10/2014 17:00     25.95       26.78     24.93   985.89   977.66
## 472 29/10/2014 18:00     25.90       26.13     24.79   893.49   881.29
## 473 29/10/2014 19:00     25.80       26.10     24.90   713.71   700.45
## 474 30/10/2014  9:00     24.24       25.61     24.44   455.04   588.82
## 475 30/10/2014 10:00     24.84       26.01     24.66   487.32   652.66
## 476 30/10/2014 11:00     25.45       26.38     24.94   469.05   693.10
## 477 30/10/2014 12:00     25.89       27.03     25.21   611.61   742.06
## 478 30/10/2014 13:00     25.93       27.13     24.95   734.41   739.92
## 479 30/10/2014 14:00     25.93       27.15     24.86   672.60   699.83
## 480 30/10/2014 15:00     25.99       27.15     24.85   686.27   687.26
## 481 30/10/2014 16:00     26.06       27.20     24.94   852.44   741.88
## 482 30/10/2014 17:00     26.23       27.11     25.02   871.33   744.91
## 483 30/10/2014 18:00     25.96       26.25     24.74   887.57   806.26
## 484 30/10/2014 19:00     25.84       26.12     24.79   665.63   641.16
## 485 31/10/2014  9:00     24.92       26.12     24.75   483.44   625.91
## 486 31/10/2014 10:00     25.52       26.37     24.96   567.20   663.20
## 487 31/10/2014 11:00     25.82       26.55     25.10   552.10   634.21
## 488 31/10/2014 12:00     25.99       26.53     24.89   672.34   674.37
## 489 31/10/2014 13:00     25.94       26.27     24.60   662.86   698.94
## 490 31/10/2014 14:00     26.02       26.29     24.70   609.13   646.39
## 491 31/10/2014 15:00     26.67       26.81     25.12   713.15   805.97
## 492 31/10/2014 16:00     27.00       27.04     25.58   765.64   790.40
## 493 31/10/2014 17:00     27.20       27.02     25.87   734.95   770.48
## 494 31/10/2014 18:00     26.69       26.73     25.72   666.46   706.30
## 495 31/10/2014 19:00     26.01       26.36     25.41   522.27   597.42
##     CO2Entrada HRFondo HRMedio HREntrada ConsumoUE03       Dia   TipoDia
## 1       407.26   50.98   49.88     48.95        1.24     Lunes Laborable
## 2       577.23   46.53   47.41     47.34        3.56     Lunes Laborable
## 3       671.41   46.45   47.80     47.81        1.39     Lunes Laborable
## 4       675.12   50.53   51.00     50.29        0.30     Lunes Laborable
## 5       544.34   51.37   53.00     49.86        0.30     Lunes Laborable
## 6       497.89   47.95   53.52     48.44        3.39     Lunes Laborable
## 7       427.63   45.76   53.53     47.73        8.00     Lunes Laborable
## 8       583.40   43.22   48.71     45.02        4.40     Lunes Laborable
## 9       729.81   41.69   49.16     44.28        4.30     Lunes Laborable
## 10      612.39   42.45   53.15     45.83        4.24     Lunes Laborable
## 11      475.96   43.39   53.85     46.56        4.10     Lunes Laborable
## 12      408.26   51.34   50.48     49.26        1.27    Martes Laborable
## 13      556.32   44.82   47.23     46.44        3.82    Martes Laborable
## 14      671.53   43.21   48.30     45.65        3.24    Martes Laborable
## 15      652.39   43.30   50.68     46.17        4.80    Martes Laborable
## 16      591.06   45.54   52.83     47.58        9.00    Martes Laborable
## 17      441.74   51.70   55.51     50.38        4.35    Martes Laborable
## 18      380.49   48.81   58.80     51.29        4.41    Martes Laborable
## 19      365.28   50.59   59.87     52.59        4.80    Martes Laborable
## 20      421.10   46.40   57.97     50.23        4.90    Martes Laborable
## 21      624.45   40.13   48.72     43.96        4.45    Martes Laborable
## 22      661.43   40.57   47.90     44.49        4.39    Martes Laborable
## 23      410.21   50.22   50.19     49.24        1.26 Miércoles Laborable
## 24      559.16   44.94   47.16     46.68        3.14 Miércoles Laborable
## 25      579.81   47.35   48.90     49.12        2.54 Miércoles Laborable
## 26      625.11   49.94   50.98     50.40        1.95 Miércoles Laborable
## 27      684.38   47.22   49.29     48.65        2.12 Miércoles Laborable
## 28      657.95   46.98   49.56     48.80        2.60 Miércoles Laborable
## 29      614.13   47.04   49.74     48.88        2.51 Miércoles Laborable
## 30      606.81   46.71   49.33     48.04        2.88 Miércoles Laborable
## 31      708.67   45.51   49.17     48.10        2.00 Miércoles Laborable
## 32      718.64   44.83   49.96     47.68        2.75 Miércoles Laborable
## 33      805.66   45.11   49.38     48.32        2.38 Miércoles Laborable
## 34      406.35   55.81   53.67     53.09        0.13    Jueves Laborable
## 35      512.57   54.95   53.78     53.87        1.29    Jueves Laborable
## 36      602.93   55.45   54.46     54.30        1.19    Jueves Laborable
## 37      605.73   53.03   53.25     53.20        1.43    Jueves Laborable
## 38      601.98   52.21   53.28     52.80        1.57    Jueves Laborable
## 39      637.82   51.04   52.79     51.96        2.20    Jueves Laborable
## 40      547.41   49.41   52.39     52.20        1.28    Jueves Laborable
## 41      599.09   47.98   51.76     51.09        1.69    Jueves Laborable
## 42      634.11   48.02   51.98     51.07        1.17    Jueves Laborable
## 43      741.82   47.99   51.63     50.63        1.35    Jueves Laborable
## 44      774.29   44.51   48.50     48.12        3.82    Jueves Laborable
## 45      394.73   55.25   52.62     52.03        1.16   Viernes Laborable
## 46      673.91   53.20   52.37     52.44        5.00   Viernes Laborable
## 47      765.91   51.58   51.62     51.17        2.52   Viernes Laborable
## 48      832.10   51.35   51.61     51.02        2.51   Viernes Laborable
## 49      780.90   52.14   53.08     51.40        0.12   Viernes Laborable
## 50      585.53   49.26   53.88     51.55        0.30   Viernes Laborable
## 51      520.81   49.26   53.75     51.39        0.30   Viernes Laborable
## 52      479.30   48.74   53.15     49.67        1.15   Viernes Laborable
## 53      540.02   43.66   49.23     46.13        3.83   Viernes Laborable
## 54      540.41   42.74   49.17     46.04        3.94   Viernes Laborable
## 55      541.04   42.17   48.65     45.71        3.66   Viernes Laborable
## 56      395.08   61.71   56.72     55.50        0.14     Lunes Laborable
## 57      626.34   60.10   56.90     55.71        0.92     Lunes Laborable
## 58      715.17   58.87   56.19     55.89        1.60     Lunes Laborable
## 59      669.84   58.45   56.62     56.36        1.48     Lunes Laborable
## 60      663.02   60.73   59.43     58.35        0.27     Lunes Laborable
## 61      590.80   54.25   56.40     53.50        2.92     Lunes Laborable
## 62      368.06   60.92   61.64     57.89        1.88     Lunes Laborable
## 63      416.69   56.49   60.37     54.93        7.00     Lunes Laborable
## 64      756.17   48.97   53.91     49.39        3.86     Lunes Laborable
## 65      843.53   47.09   51.67     47.65        3.90     Lunes Laborable
## 66      802.39   44.95   51.38     47.18        3.93     Lunes Laborable
## 67      385.80   58.70   55.39     54.27        0.13    Martes Laborable
## 68      541.79   57.24   55.22     54.22        1.35    Martes Laborable
## 69      581.05   56.59   54.90     54.33        1.73    Martes Laborable
## 70      618.32   54.08   54.52     53.13        2.70    Martes Laborable
## 71      648.45   54.88   56.56     54.20        1.15    Martes Laborable
## 72      575.81   54.17   57.61     53.39        1.55    Martes Laborable
## 73      517.24   53.09   57.08     52.89        2.70    Martes Laborable
## 74      561.78   49.92   54.71     49.57        3.35    Martes Laborable
## 75      557.74   47.53   52.70     48.46        3.47    Martes Laborable
## 76      575.39   47.43   52.28     49.15        3.30    Martes Laborable
## 77      583.60   45.94   51.07     47.91        2.00    Martes Laborable
## 78      437.37   56.80   54.35     53.24        0.14 Miércoles Laborable
## 79      613.50   53.67   53.46     51.98        1.88 Miércoles Laborable
## 80      702.32   46.38   49.68     48.29        3.87 Miércoles Laborable
## 81      783.55   49.35   52.00     50.22        9.00 Miércoles Laborable
## 82      720.66   52.70   54.19     51.47        1.31 Miércoles Laborable
## 83      772.30   50.67   53.44     50.58        2.38 Miércoles Laborable
## 84      644.11   50.13   53.51     49.76        2.86 Miércoles Laborable
## 85      576.24   48.05   52.60     48.50        6.00 Miércoles Laborable
## 86      819.75   45.60   50.64     46.98        3.13 Miércoles Laborable
## 87      883.53   45.09   49.82     47.27        3.11 Miércoles Laborable
## 88      886.99   41.12   48.07     44.67        3.87 Miércoles Laborable
## 89      394.36   52.97   51.98     50.87        0.14    Jueves Laborable
## 90      549.60   53.44   52.48     51.33        1.39    Jueves Laborable
## 91      580.29   52.31   52.00     51.38        7.00    Jueves Laborable
## 92      625.26   53.47   53.50     52.60        1.60    Jueves Laborable
## 93      618.50   50.68   52.86     51.40        1.75    Jueves Laborable
## 94      637.23   49.43   51.80     49.70        3.00    Jueves Laborable
## 95      629.80   47.90   51.64     49.19        2.39    Jueves Laborable
## 96      617.70   47.40   51.06     48.27        2.85    Jueves Laborable
## 97      720.04   42.63   48.40     44.83        3.68    Jueves Laborable
## 98      682.88   42.03   49.06     45.57        3.90    Jueves Laborable
## 99      721.84   40.31   46.43     43.96        3.89    Jueves Laborable
## 100     372.81   55.48   52.74     51.59        0.13   Viernes Laborable
## 101     495.25   54.11   52.16     51.58        1.58   Viernes Laborable
## 102     549.76   51.74   52.12     51.22        1.39   Viernes Laborable
## 103     632.69   51.97   52.43     50.83        1.98   Viernes Laborable
## 104     542.71   51.48   52.53     51.11        1.76   Viernes Laborable
## 105     494.65   52.35   53.21     51.43        2.24   Viernes Laborable
## 106     420.88   53.72   53.84     51.78        1.68   Viernes Laborable
## 107     518.09   51.65   52.66     50.54        8.00   Viernes Laborable
## 108     649.98   48.06   50.76     49.15        2.88   Viernes Laborable
## 109     702.18   47.46   50.38     49.31        2.68   Viernes Laborable
## 110     651.65   49.22   51.10     50.62        2.30   Viernes Laborable
## 111     366.49   56.43   53.15     52.19        0.14     Lunes Laborable
## 112     528.31   53.49   52.81     51.63        0.27     Lunes Laborable
## 113     573.57   52.63   53.09     51.49        0.27     Lunes Laborable
## 114     589.93   53.02   53.50     51.35        0.85     Lunes Laborable
## 115     594.79   53.91   54.31     52.13        1.38     Lunes Laborable
## 116     527.53   54.06   54.94     52.27        1.23     Lunes Laborable
## 117     467.54   54.83   55.39     52.48        0.99     Lunes Laborable
## 118     557.75   52.74   54.17     51.59        1.65     Lunes Laborable
## 119     634.22   50.47   53.27     50.37        2.53     Lunes Laborable
## 120     566.73   49.90   53.02     50.05        2.00     Lunes Laborable
## 121     478.79   51.66   53.47     52.17        4.00     Lunes Laborable
## 122     334.74   60.89   56.33     55.39        0.13    Martes Laborable
## 123     528.25   60.66   57.45     56.63        0.26    Martes Laborable
## 124     753.87   59.39   57.64     55.76        0.26    Martes Laborable
## 125     755.98   56.55   57.46     54.52        0.83    Martes Laborable
## 126     684.83   54.79   57.64     53.93        1.24    Martes Laborable
## 127     733.74   53.40   56.19     52.45        2.90    Martes Laborable
## 128     650.60   52.27   54.69     51.30        1.88    Martes Laborable
## 129     615.06   51.32   53.87     50.94        1.96    Martes Laborable
## 130     643.33   49.04   52.75     49.60        2.60    Martes Laborable
## 131     748.73   48.71   52.46     49.97        2.50    Martes Laborable
## 132     676.35   50.65   53.44     51.59        1.82    Martes Laborable
## 133     337.68   60.26   56.11     54.88        0.14 Miércoles Laborable
## 134     355.96   59.66   57.23     55.29        0.26 Miércoles Laborable
## 135     422.06   59.00   57.52     55.59        6.00 Miércoles Laborable
## 136     579.11   57.95   57.59     55.14        0.26 Miércoles Laborable
## 137     647.93   55.34   55.99     53.61        1.26 Miércoles Laborable
## 138     675.17   56.58   57.17     55.19        0.83 Miércoles Laborable
## 139     582.26   55.79   57.06     54.25        1.21 Miércoles Laborable
## 140     544.73   55.01   56.51     53.52        1.45 Miércoles Laborable
## 141     649.62   53.64   55.88     53.22        1.35 Miércoles Laborable
## 142     711.69   53.76   55.77     53.45        1.83 Miércoles Laborable
## 143     579.75   50.74   54.07     51.03        1.95 Miércoles Laborable
## 144     341.95   58.79   55.19     54.16        0.14    Jueves Laborable
## 145     501.44   58.06   55.97     54.46        0.26    Jueves Laborable
## 146     541.73   56.13   55.51     53.61        0.27    Jueves Laborable
## 147     555.72   55.28   55.30     53.15        0.27    Jueves Laborable
## 148     542.58   54.59   55.07     52.14        7.00    Jueves Laborable
## 149     554.80   52.28   54.54     51.74        0.96    Jueves Laborable
## 150     593.54   52.28   54.67     51.86        0.62    Jueves Laborable
## 151     578.76   53.41   54.99     52.23        6.00    Jueves Laborable
## 152     618.93   54.98   56.16     53.85        0.56    Jueves Laborable
## 153     663.11   53.36   54.99     53.00        3.00    Jueves Laborable
## 154     642.12   56.52   56.68     55.31        0.86    Jueves Laborable
## 155     351.92   60.92   56.47     55.24        4.00   Viernes Laborable
## 156     550.39   60.10   57.45     55.77        0.27   Viernes Laborable
## 157     581.42   58.94   57.57     55.23        0.27   Viernes Laborable
## 158     504.73   57.51   57.09     54.43        0.27   Viernes Laborable
## 159     451.43   55.97   56.50     53.60        0.27   Viernes Laborable
## 160     414.75   55.32   56.22     53.57        0.44   Viernes Laborable
## 161     391.32   55.91   56.56     54.19        0.27   Viernes Laborable
## 162     512.99   56.17   57.09     54.67        0.68   Viernes Laborable
## 163     512.82   57.28   58.08     55.77        0.79   Viernes Laborable
## 164     551.45   57.57   58.33     56.57        0.44   Viernes Laborable
## 165     582.86   58.07   58.09     56.24        0.27   Viernes Laborable
## 166     348.87   62.47   57.73     56.00        4.00     Lunes Laborable
## 167     409.10   61.34   58.36     56.21        0.27     Lunes Laborable
## 168     392.46   59.82   58.41     55.88        0.27     Lunes Laborable
## 169     447.92   58.38   57.87     54.91        0.27     Lunes Laborable
## 170     443.52   55.36   56.89     53.56        0.45     Lunes Laborable
## 171     419.71   54.49   56.36     52.86        1.50     Lunes Laborable
## 172     340.18   56.88   58.34     54.09        1.49     Lunes Laborable
## 173     337.03   56.42   59.09     55.53        1.22     Lunes Laborable
## 174     353.91   56.47   59.25     56.26        1.44     Lunes Laborable
## 175     358.15   58.74   59.94     57.25        1.00     Lunes Laborable
## 176     386.02   60.11   60.46     58.57        0.84     Lunes Laborable
## 177     340.24   62.52   57.78     56.77        0.14    Martes Laborable
## 178     394.71   60.15   58.09     56.55        0.27    Martes Laborable
## 179     393.41   57.89   57.36     55.50        0.27    Martes Laborable
## 180     380.43   56.68   57.03     54.76        0.27    Martes Laborable
## 181     408.26   56.06   56.55     54.15        0.27    Martes Laborable
## 182     470.21   55.34   56.18     53.71        0.27    Martes Laborable
## 183     432.26   53.84   55.54     52.79        0.27    Martes Laborable
## 184     465.48   52.23   54.82     51.60        0.80    Martes Laborable
## 185     480.77   51.87   55.10     51.71        1.20    Martes Laborable
## 186     435.60   50.85   54.57     51.51        0.81    Martes Laborable
## 187     428.28   50.57   54.17     51.45        0.77    Martes Laborable
## 188     380.43   56.36   53.24     51.97        0.14 Miércoles Laborable
## 189     624.30   54.48   53.34     51.75        7.00 Miércoles Laborable
## 190     719.00   53.45   53.69     51.78        7.00 Miércoles Laborable
## 191     674.88   52.53   53.75     51.32        0.27 Miércoles Laborable
## 192     438.60   48.54   52.71     49.65        0.27 Miércoles Laborable
## 193     378.05   46.38   51.74     48.18        0.27 Miércoles Laborable
## 194     391.31   44.72   50.92     46.79        0.27 Miércoles Laborable
## 195     401.25   42.44   49.97     45.40        0.27 Miércoles Laborable
## 196     426.05   41.56   49.15     44.57        1.65 Miércoles Laborable
## 197     385.94   43.40   50.09     45.59        1.56 Miércoles Laborable
## 198     410.01   45.12   50.81     46.50        1.43 Miércoles Laborable
## 199     398.20   51.83   50.85     49.44        0.14    Jueves Laborable
## 200     613.11   50.67   50.74     48.79        0.27    Jueves Laborable
## 201     690.71   49.78   51.03     48.79        7.00    Jueves Laborable
## 202     709.13   49.27   51.45     48.79        0.27    Jueves Laborable
## 203     629.57   49.03   51.90     48.82        7.00    Jueves Laborable
## 204     463.65   48.73   52.04     48.22        0.27    Jueves Laborable
## 205     460.33   47.91   52.11     47.57        0.27    Jueves Laborable
## 206     616.19   47.73   52.44     47.33        0.55    Jueves Laborable
## 207     540.21   46.54   52.08     46.71        1.80    Jueves Laborable
## 208     446.61   45.19   51.80     46.44        3.00    Jueves Laborable
## 209     354.12   44.72   52.46     48.06        1.31    Jueves Laborable
## 210     387.09   51.37   50.75     49.10        0.14   Viernes Laborable
## 211     560.51   50.59   51.08     49.02        0.27   Viernes Laborable
## 212     631.41   50.21   51.43     49.17        0.27   Viernes Laborable
## 213     595.36   50.36   51.72     49.00        4.00   Viernes Laborable
## 214     542.70   49.51   51.94     48.12        2.48   Viernes Laborable
## 215     468.63   48.30   51.68     47.68        0.41   Viernes Laborable
## 216     384.68   49.12   52.87     48.13        0.30   Viernes Laborable
## 217     367.17   45.91   51.45     46.63        0.84   Viernes Laborable
## 218     561.11   40.79   50.12     44.09        3.67   Viernes Laborable
## 219     549.92   40.57   50.16     44.48        3.79   Viernes Laborable
## 220     414.32   43.84   50.36     45.26        1.15   Viernes Laborable
## 221     389.58   58.46   55.23     53.20        0.14     Lunes Laborable
## 222     644.48   56.85   55.50     52.75        0.27     Lunes Laborable
## 223     651.22   54.92   55.01     52.22        0.27     Lunes Laborable
## 224     534.48   54.71   55.12     52.02        0.27     Lunes Laborable
## 225     535.85   54.36   55.12     51.72        0.27     Lunes Laborable
## 226     510.42   53.20   54.81     50.69        0.91     Lunes Laborable
## 227     506.59   51.94   54.29     49.81        1.28     Lunes Laborable
## 228     554.25   49.76   53.73     48.61        8.00     Lunes Laborable
## 229     510.16   47.59   52.95     48.56        2.72     Lunes Laborable
## 230     677.55   43.67   50.91     45.72        3.43     Lunes Laborable
## 231     736.58   41.11   49.75     44.23        3.17     Lunes Laborable
## 232     379.67   53.38   52.03     50.22        0.14    Martes Laborable
## 233     593.50   51.15   51.39     49.53        7.00    Martes Laborable
## 234     636.84   49.91   51.28     48.99        0.27    Martes Laborable
## 235     606.00   49.75   51.82     49.06        7.00    Martes Laborable
## 236     525.91   50.21   52.72     49.69        0.27    Martes Laborable
## 237     494.20   49.65   52.91     49.10        8.00    Martes Laborable
## 238     487.16   50.68   53.97     49.43        3.00    Martes Laborable
## 239     476.29   51.41   54.48     49.51        1.81    Martes Laborable
## 240     559.83   50.01   53.67     48.69        2.72    Martes Laborable
## 241     671.27   44.11   51.62     45.35        3.00    Martes Laborable
## 242     584.79   50.58   53.48     49.16        0.97    Martes Laborable
## 243     636.48   52.21   52.42     49.94        0.27 Miércoles Laborable
## 244     682.76   50.81   52.36     49.73        0.27 Miércoles Laborable
## 245     670.18   50.71   52.71     49.80        0.27 Miércoles Laborable
## 246     579.91   50.77   53.29     50.16        0.27 Miércoles Laborable
## 247     608.75   51.09   54.28     50.38        1.70 Miércoles Laborable
## 248     538.49   52.20   55.28     50.17        0.91 Miércoles Laborable
## 249     561.61   52.08   55.45     50.02        2.74 Miércoles Laborable
## 250     459.75   50.42   54.20     49.93        3.25 Miércoles Laborable
## 251     416.79   48.47   54.82     48.53        3.83 Miércoles Laborable
## 252     368.39   54.32   56.70     51.00        5.00 Miércoles Laborable
## 253     334.54   52.81   56.28     51.09        0.30 Miércoles Laborable
## 254     580.15   54.33   53.73     51.52        0.26    Jueves Laborable
## 255     642.60   53.59   53.81     51.61        0.26    Jueves Laborable
## 256     581.43   54.61   54.30     51.42        0.26    Jueves Laborable
## 257     617.25   54.37   54.92     51.53        0.97    Jueves Laborable
## 258     515.18   54.23   56.13     51.68        2.20    Jueves Laborable
## 259     406.71   53.57   57.27     52.01        1.26    Jueves Laborable
## 260     432.73   51.40   56.30     49.62        3.21    Jueves Laborable
## 261     530.30   44.54   55.05     46.88        3.88    Jueves Laborable
## 262     601.47   42.37   55.00     46.85        7.00    Jueves Laborable
## 263     527.38   46.46   54.65     47.89        3.81    Jueves Laborable
## 264     413.18   49.09   55.57     49.17        0.85    Jueves Laborable
## 265     634.79   54.06   53.42     51.51        0.27   Viernes Laborable
## 266     670.63   53.11   53.80     51.07        0.27   Viernes Laborable
## 267     696.20   51.43   53.70     50.29        0.99   Viernes Laborable
## 268     663.89   52.87   54.40     51.36        1.57   Viernes Laborable
## 269     566.09   51.63   54.53     50.55        1.78   Viernes Laborable
## 270     452.31   50.28   55.01     50.24        2.18   Viernes Laborable
## 271     501.08   49.12   53.11     48.52        9.00   Viernes Laborable
## 272     686.46   44.08   51.59     45.63        3.81   Viernes Laborable
## 273     780.41   42.39   50.42     44.66        3.55   Viernes Laborable
## 274     601.89   45.35   50.27     46.16        2.42   Viernes Laborable
## 275     397.20   51.17   53.22     49.68        0.90   Viernes Laborable
## 276     614.66   57.29   56.31     53.58        0.27     Lunes Laborable
## 277     628.69   57.09   56.95     54.03        0.27     Lunes Laborable
## 278     593.73   57.50   57.54     54.52        0.27     Lunes Laborable
## 279     588.35   58.19   58.08     54.90        0.27     Lunes Laborable
## 280     583.13   58.80   58.72     55.47        0.27     Lunes Laborable
## 281     548.79   59.36   59.18     55.96        0.27     Lunes Laborable
## 282     459.40   60.17   59.72     56.49        0.27     Lunes Laborable
## 283     488.53   59.33   59.37     56.65        0.27     Lunes Laborable
## 284     460.45   58.35   58.79     55.97        0.27     Lunes Laborable
## 285     463.57   57.90   58.51     55.22        0.27     Lunes Laborable
## 286     410.95   58.38   58.10     54.74        0.14     Lunes Laborable
## 287     590.82   60.67   58.38     55.68        0.27    Martes Laborable
## 288     637.45   59.41   58.65     55.56        0.27    Martes Laborable
## 289     638.49   58.75   58.85     55.45        0.27    Martes Laborable
## 290     711.41   57.81   58.51     55.04        0.27    Martes Laborable
## 291     698.17   57.25   58.40     54.77        0.27    Martes Laborable
## 292     417.02   56.19   57.09     53.07        0.27    Martes Laborable
## 293     551.99   55.92   57.52     53.72        0.27    Martes Laborable
## 294     647.48   56.53   58.10     54.48        0.27    Martes Laborable
## 295     669.01   57.06   58.52     55.04        0.27    Martes Laborable
## 296     633.62   57.47   58.73     55.54        0.27    Martes Laborable
## 297     603.28   58.56   58.91     56.28        0.27    Martes Laborable
## 298     615.83   62.84   60.02     57.90        0.27 Miércoles Laborable
## 299     751.92   62.12   60.61     58.44        0.27 Miércoles Laborable
## 300     748.39   62.10   61.00     58.66        7.00 Miércoles Laborable
## 301     699.42   61.89   60.88     58.32        0.27 Miércoles Laborable
## 302     711.36   60.73   60.26     57.68        0.27 Miércoles Laborable
## 303     654.91   60.14   59.79     57.05        0.27 Miércoles Laborable
## 304     626.43   59.33   59.24     56.39        0.27 Miércoles Laborable
## 305     694.95   58.13   58.62     55.69        0.27 Miércoles Laborable
## 306     677.08   57.35   58.03     54.91        0.27 Miércoles Laborable
## 307     569.75   56.69   57.31     53.98        0.27 Miércoles Laborable
## 308     464.50   56.92   56.61     53.49        0.14 Miércoles Laborable
## 309     602.09   60.43   58.12     55.72        0.27    Jueves Laborable
## 310     706.51   58.86   57.99     55.69        0.27    Jueves Laborable
## 311     727.99   58.37   58.14     55.63        0.27    Jueves Laborable
## 312     752.69   57.77   58.23     55.48        0.27    Jueves Laborable
## 313     689.80   57.51   58.16     55.19        0.27    Jueves Laborable
## 314     635.31   57.62   58.45     55.29        0.27    Jueves Laborable
## 315     615.54   57.81   58.68     53.97        0.27    Jueves Laborable
## 316     589.30   55.31   57.56     52.69        0.27    Jueves Laborable
## 317     611.66   54.96   57.35     53.03        0.27    Jueves Laborable
## 318     546.46   55.77   57.01     53.30        0.27    Jueves Laborable
## 319     439.06   56.20   56.74     53.25        0.14    Jueves Laborable
## 320     558.48   59.97   57.09     54.95        0.27   Viernes Laborable
## 321     705.50   58.85   57.22     54.78        0.27   Viernes Laborable
## 322     781.35   58.31   57.57     54.70        0.26   Viernes Laborable
## 323     849.21   57.10   57.56     54.16        0.30   Viernes Laborable
## 324     762.80   56.12   57.58     53.19        0.30   Viernes Laborable
## 325     586.60   54.93   57.22     52.70        0.30   Viernes Laborable
## 326     484.28   54.02   56.71     52.14        0.30   Viernes Laborable
## 327     758.54   53.90   57.05     52.22        0.30   Viernes Laborable
## 328     732.24   53.20   56.52     52.38        0.30   Viernes Laborable
## 329     609.47   54.03   56.36     52.87        0.30   Viernes Laborable
## 330     593.78   55.47   56.72     53.62        0.30   Viernes Laborable
## 331     712.58   61.98   59.72     57.66        0.30     Lunes Laborable
## 332     888.70   61.25   59.91     57.33        0.30     Lunes Laborable
## 333     956.70   59.82   59.56     56.82        0.30     Lunes Laborable
## 334     795.17   59.68   59.43     56.24        0.30     Lunes Laborable
## 335     834.98   57.95   59.10     56.08        0.30     Lunes Laborable
## 336     878.81   57.34   58.64     55.89        0.30     Lunes Laborable
## 337     923.51   57.01   58.82     55.87        0.30     Lunes Laborable
## 338    1000.10   55.92   58.46     55.68        0.30     Lunes Laborable
## 339     758.59   52.78   56.63     54.26        0.30     Lunes Laborable
## 340     704.81   51.45   55.09     53.53        0.30     Lunes Laborable
## 341     882.19   53.99   55.71     54.91        0.30     Lunes Laborable
## 342     511.50   55.02   55.00     51.60        4.00    Martes Laborable
## 343     610.08   51.46   54.00     50.52        6.00    Martes Laborable
## 344     717.98   50.09   53.74     50.35        0.27    Martes Laborable
## 345     717.68   51.16   54.56     51.08        0.27    Martes Laborable
## 346     591.65   51.31   55.06     50.76        0.27    Martes Laborable
## 347     491.16   51.64   55.32     50.33        0.27    Martes Laborable
## 348     487.36   51.84   55.46     50.27        0.27    Martes Laborable
## 349     475.22   51.55   55.37     50.06        0.27    Martes Laborable
## 350     586.78   51.48   55.74     50.31        0.27    Martes Laborable
## 351     523.72   51.56   55.81     51.00        7.00    Martes Laborable
## 352     436.85   53.05   55.81     52.54        0.14    Martes Laborable
## 353     459.65   60.98   58.07     54.85        0.27 Miércoles Laborable
## 354     677.34   60.68   58.97     55.83        0.27 Miércoles Laborable
## 355     724.78   62.27   60.05     56.68        0.27 Miércoles Laborable
## 356     787.58   61.81   60.88     57.69        7.00 Miércoles Laborable
## 357     663.40   62.08   61.33     58.29        0.27 Miércoles Laborable
## 358     597.07   62.74   61.56     58.42        0.27 Miércoles Laborable
## 359     700.54   62.46   62.66     58.41        0.27 Miércoles Laborable
## 360     727.31   61.94   62.63     58.22        0.27 Miércoles Laborable
## 361     642.56   61.65   62.24     58.23        0.27 Miércoles Laborable
## 362     535.38   60.00   60.85     57.11        7.00 Miércoles Laborable
## 363     458.15   60.93   60.04     56.95        0.14 Miércoles Laborable
## 364     645.56   59.93   58.59     56.56        0.27    Jueves Laborable
## 365     711.42   58.82   58.43     56.52        0.27    Jueves Laborable
## 366     701.98   59.10   58.88     56.65        0.27    Jueves Laborable
## 367     791.58   60.05   59.87     57.30        0.27    Jueves Laborable
## 368     663.33   59.44   59.61     57.21        0.27    Jueves Laborable
## 369     597.63   60.36   60.05     57.48        0.27    Jueves Laborable
## 370     697.49   60.32   60.26     57.57        0.27    Jueves Laborable
## 371     647.74   59.38   59.91     57.43        0.27    Jueves Laborable
## 372     656.86   60.21   60.18     57.36        0.26    Jueves Laborable
## 373     772.27   57.70   58.96     56.67        0.29    Jueves Laborable
## 374     727.85   58.54   58.76     55.81        0.15    Jueves Laborable
## 375     516.99   62.32   59.98     56.20        0.27   Viernes Laborable
## 376     732.65   61.14   60.19     56.82        0.27   Viernes Laborable
## 377     753.76   60.48   60.07     56.67        0.27   Viernes Laborable
## 378     679.47   59.54   59.88     56.12        0.27   Viernes Laborable
## 379     633.56   58.97   59.81     55.62        0.27   Viernes Laborable
## 380     482.79   59.38   59.97     55.12        0.27   Viernes Laborable
## 381     499.22   59.49   60.22     54.70        0.27   Viernes Laborable
## 382     563.78   60.39   60.87     55.64        0.27   Viernes Laborable
## 383     434.19   59.20   60.20     54.60        0.27   Viernes Laborable
## 384     466.61   58.08   59.38     53.99        0.27   Viernes Laborable
## 385     384.93   57.74   58.76     53.97        0.14   Viernes Laborable
## 386     633.65   58.22   56.98     54.49        0.27     Lunes Laborable
## 387     727.76   57.87   57.25     54.86        0.27     Lunes Laborable
## 388     755.43   58.31   58.15     55.28        0.27     Lunes Laborable
## 389     619.17   57.76   58.36     54.75        0.26     Lunes Laborable
## 390     538.02   57.49   58.54     54.59        0.26     Lunes Laborable
## 391     543.81   57.67   58.75     53.72        0.26     Lunes Laborable
## 392     572.79   53.43   57.15     50.88        2.19     Lunes Laborable
## 393     769.99   45.03   54.88     46.68        3.92     Lunes Laborable
## 394     892.91   45.10   51.67     47.12        3.15     Lunes Laborable
## 395     808.22   52.77   54.83     52.56        1.12     Lunes Laborable
## 396     660.10   56.48   57.24     53.72        0.70     Lunes Laborable
## 397     744.90   58.87   57.15     54.14        0.27    Martes Laborable
## 398     868.99   58.19   57.35     54.42        0.27    Martes Laborable
## 399     882.90   57.67   57.45     54.34        0.27    Martes Laborable
## 400     885.75   55.07   56.08     52.60        1.26    Martes Laborable
## 401     846.12   56.75   57.55     53.79        1.28    Martes Laborable
## 402     719.68   59.05   59.43     55.81        0.73    Martes Laborable
## 403     662.27   57.42   57.85     54.24        1.46    Martes Laborable
## 404     909.47   55.73   56.87     53.79        0.11    Martes Laborable
## 405     886.03   57.00   59.07     55.96        0.30    Martes Laborable
## 406     729.28   53.53   57.00     54.19        1.00    Martes Laborable
## 407     666.58   54.93   56.81     53.45        0.16    Martes Laborable
## 408     671.51   59.20   56.38     54.34        0.31 Miércoles Laborable
## 409     679.19   57.37   56.12     53.74        1.00 Miércoles Laborable
## 410     704.51   56.24   56.04     53.49        0.31 Miércoles Laborable
## 411     737.93   55.76   56.08     53.03        0.31 Miércoles Laborable
## 412     781.10   54.74   56.13     52.21        0.31 Miércoles Laborable
## 413     801.63   54.36   56.17     51.30        0.30 Miércoles Laborable
## 414     849.83   50.28   55.03     48.69        2.49 Miércoles Laborable
## 415     908.99   44.71   53.27     45.64        3.87 Miércoles Laborable
## 416     725.35   44.78   53.57     46.75        3.58 Miércoles Laborable
## 417     727.23   44.69   52.49     46.04        3.58 Miércoles Laborable
## 418     635.59   47.39   51.91     47.85        1.56 Miércoles Laborable
## 419     603.52   52.04   52.56     49.35        0.27    Jueves Laborable
## 420     707.95   47.68   50.63     47.83        0.27    Jueves Laborable
## 421     765.15   48.63   51.55     48.43        0.27    Jueves Laborable
## 422     780.99   47.00   51.05     47.67        7.00    Jueves Laborable
## 423     780.42   45.82   51.08     47.10        0.89    Jueves Laborable
## 424     718.95   44.56   49.49     44.94        3.70    Jueves Laborable
## 425     773.90   44.91   49.95     45.24        2.76    Jueves Laborable
## 426     805.46   43.01   49.74     44.35        3.64    Jueves Laborable
## 427     906.52   43.26   50.98     44.93        3.60    Jueves Laborable
## 428     962.82   43.93   51.43     45.74        2.97    Jueves Laborable
## 429     795.83   50.78   53.50     50.11        0.61    Jueves Laborable
## 430     613.61   56.82   55.60     52.97        7.00   Viernes Laborable
## 431     680.95   55.87   55.65     53.06        0.26   Viernes Laborable
## 432     718.08   54.52   55.27     52.76        0.26   Viernes Laborable
## 433     816.80   52.82   54.87     51.89        0.26   Viernes Laborable
## 434     829.26   50.21   53.67     49.59        2.40   Viernes Laborable
## 435     814.48   45.47   51.49     46.83        3.61   Viernes Laborable
## 436     898.68   44.58   50.19     46.34        3.41   Viernes Laborable
## 437     940.98   45.34   49.55     47.89        2.54   Viernes Laborable
## 438     765.53   49.76   51.87     50.52        1.36   Viernes Laborable
## 439     426.93   53.62   54.21     51.71        0.30   Viernes Laborable
## 440     359.19   53.28   53.92     51.44        0.16   Viernes Laborable
## 441     603.84   56.62   55.17     52.69        0.30     Lunes Laborable
## 442     545.27   55.82   55.23     51.52        0.30     Lunes Laborable
## 443     518.15   55.36   55.43     51.09        0.30     Lunes Laborable
## 444     603.38   54.80   55.61     50.93        0.30     Lunes Laborable
## 445     445.82   53.13   54.55     49.48        0.30     Lunes Laborable
## 446     427.70   49.58   53.22     48.08        0.65     Lunes Laborable
## 447     613.35   45.18   50.39     45.64        3.59     Lunes Laborable
## 448     655.26   43.09   49.36     44.67        3.60     Lunes Laborable
## 449     739.30   44.42   50.09     46.18        1.20     Lunes Laborable
## 450     654.90   48.26   52.42     48.59        0.30     Lunes Laborable
## 451     449.12   50.12   53.09     49.54        0.30     Lunes Laborable
## 452     494.61   51.85   53.12     49.46        0.30    Martes Laborable
## 453     477.23   51.18   52.58     48.93        0.30    Martes Laborable
## 454     683.74   49.53   52.55     49.67        0.30    Martes Laborable
## 455     822.24   49.27   52.91     49.59        0.30    Martes Laborable
## 456     804.33   47.59   52.56     48.55        0.50    Martes Laborable
## 457     740.65   42.29   49.10     44.04        3.83    Martes Laborable
## 458     765.04   41.62   47.85     43.39        3.64    Martes Laborable
## 459     852.35   41.02   47.96     43.67        3.60    Martes Laborable
## 460     824.50   40.92   46.92     43.57        3.62    Martes Laborable
## 461     676.28   40.62   46.42     44.30        3.55    Martes Laborable
## 462     522.54   43.01   47.74     46.26        1.26    Martes Laborable
## 463     689.64   51.98   52.84     50.34        0.30 Miércoles Laborable
## 464     711.56   51.57   52.89     49.92        5.00 Miércoles Laborable
## 465     603.02   51.85   52.94     50.16        1.23 Miércoles Laborable
## 466     580.39   52.19   53.57     50.59        1.13 Miércoles Laborable
## 467     675.07   50.59   53.34     49.58        2.33 Miércoles Laborable
## 468     609.43   53.52   54.69     51.68        0.39 Miércoles Laborable
## 469     664.57   50.72   53.83     48.87        2.25 Miércoles Laborable
## 470     856.66   46.34   50.81     46.33        2.83 Miércoles Laborable
## 471     868.54   45.01   50.09     45.91        2.71 Miércoles Laborable
## 472     770.60   48.35   51.37     48.77        1.44 Miércoles Laborable
## 473     568.85   52.14   53.49     50.88        0.15 Miércoles Laborable
## 474     539.45   51.50   52.50     50.30        0.30    Jueves Laborable
## 475     623.78   50.22   52.39     49.96        0.31    Jueves Laborable
## 476     614.45   50.01   52.59     49.50        0.31    Jueves Laborable
## 477     665.27   50.09   52.87     48.90        1.13    Jueves Laborable
## 478     631.00   50.51   53.46     48.76        2.00    Jueves Laborable
## 479     562.98   48.83   52.53     47.47        2.49    Jueves Laborable
## 480     581.37   45.12   50.93     45.59        3.80    Jueves Laborable
## 481     738.87   42.55   50.11     44.17        3.39    Jueves Laborable
## 482     766.61   42.44   50.35     44.71        3.50    Jueves Laborable
## 483     786.66   44.95   51.69     46.85        2.40    Jueves Laborable
## 484     546.18   52.68   54.62     51.81        0.34    Jueves Laborable
## 485     564.34   46.36   50.15     47.96        0.31   Viernes Laborable
## 486     579.97   46.29   50.26     47.65        0.31   Viernes Laborable
## 487     537.38   46.67   50.52     47.66        0.54   Viernes Laborable
## 488     546.00   47.87   51.60     48.31        7.00   Viernes Laborable
## 489     548.43   49.04   52.92     49.51        1.31   Viernes Laborable
## 490     504.87   50.18   53.59     50.10        0.33   Viernes Laborable
## 491     588.26   50.19   53.92     50.03        0.30   Viernes Laborable
## 492     629.26   50.66   54.02     50.63        0.30   Viernes Laborable
## 493     703.61   51.72   54.95     52.74        0.30   Viernes Laborable
## 494     580.59   53.59   55.32     52.85        0.30   Viernes Laborable
## 495     475.66   54.92   54.95     52.42        0.30   Viernes Laborable</code></pre>
</div>
<div id="ajuste-de-series-de-tiempo-y-grafico-de-residuos." class="section level4">
<h4><span class="header-section-number">5.1.2.2</span> Ajuste de series de tiempo y gráfico de residuos.</h4>
<p>Estudio de la humedad relativa en el fondo de la oficina
<strong>¿Normalidad, autocorrelación de la humedad relativa?</strong></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">lillie.test</span>(MultivarianteOCUP[<span class="dv">1</span><span class="op">:</span><span class="dv">418</span>,<span class="dv">9</span>]) <span class="co"># No normal</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  MultivarianteOCUP[1:418, 9]
## D = 0.063037, p-value = 0.0004167</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="kw">Box.test</span>(MultivarianteOCUP[<span class="dv">1</span><span class="op">:</span><span class="dv">418</span>,<span class="dv">9</span>]) <span class="co"># Dependencia, Xn+1 depende de Xn</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  MultivarianteOCUP[1:418, 9]
## X-squared = 283.28, df = 1, p-value &lt; 2.2e-16</code></pre>
<p>Estos gráficos no son fiables (indican + muestras fuera de control que las que en realidad son). Váse la variable Humedad Relativa (HR) del fondo de la oficina:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">qcc</span>(MultivarianteOCUP[<span class="dv">1</span><span class="op">:</span><span class="dv">418</span>,<span class="dv">9</span>],<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>) <span class="co"># Hay una cierta dependencia</span></a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre><code>## List of 11
##  $ call      : language qcc(data = MultivarianteOCUP[1:418, 9], type = &quot;xbar.one&quot;)
##  $ type      : chr &quot;xbar.one&quot;
##  $ data.name : chr &quot;MultivarianteOCUP[1:418, 9]&quot;
##  $ data      : num [1:418, 1] 51 46.5 46.5 50.5 51.4 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics: Named num [1:418] 51 46.5 46.5 50.5 51.4 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:418] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes     : int [1:418] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center    : num 53.3
##  $ std.dev   : num 1.76
##  $ nsigmas   : num 3
##  $ limits    : num [1, 1:2] 48 58.6
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations:List of 2
##  - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
<p>PROCEDIMIENTO: se ajusta un modelo de series de tiempo (ARIMA) y, una vez ajustada la autocorrelación, se controlan los residuos.Se pretende “extraer” la autocorrelación y poder aplicar de forma fiable los gráficos estándar.</p>
<p>Se utiliza la librería “forecast”, que permite un ajuste automático del modelo de series de tiempo:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">library</span>(forecast)</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;xts&#39;:
##   method     from
##   as.zoo.xts zoo</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;forecast&#39;:
##   method             from    
##   fitted.fracdiff    fracdiff
##   residuals.fracdiff fracdiff</code></pre>
<pre><code>## 
## Attaching package: &#39;forecast&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     getResponse</code></pre>
<pre><code>## The following object is masked from &#39;package:fda&#39;:
## 
##     fourier</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="co"># Se crea objeto serie de tiempo de la HR con periodo 11 (11 medidas por día)</span></a>
<a class="sourceLine" id="cb117-2" title="2">myts &lt;-<span class="st"> </span><span class="kw">ts</span>(MultivarianteOCUP[,<span class="dv">9</span>], <span class="dt">start=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">frequency=</span><span class="dv">11</span>)</a>
<a class="sourceLine" id="cb117-3" title="3"><span class="kw">plot</span>(myts)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">fit &lt;-<span class="st"> </span><span class="kw">auto.arima</span>(myts,<span class="dt">stepwise=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb118-2" title="2"></a>
<a class="sourceLine" id="cb118-3" title="3"><span class="kw">summary</span>(fit) <span class="co"># El modelo obtenido es un ARIMA(0,1,0)(2,0,0)[11]</span></a></code></pre></div>
<pre><code>## Series: myts 
## ARIMA(3,0,2)(2,1,1)[11] 
## 
## Coefficients:
##           ar1     ar2     ar3     ma1     ma2    sar1    sar2     sma1
##       -0.5605  0.6093  0.5449  1.5233  0.7137  0.1153  0.0494  -0.8433
## s.e.   0.2631  0.1233  0.1996  0.2438  0.2057  0.0637  0.0567   0.0365
## 
## sigma^2 estimated as 4.65:  log likelihood=-1060.59
## AIC=2139.18   AICc=2139.56   BIC=2176.82
## 
## Training set error measures:
##                      ME     RMSE      MAE         MPE     MAPE      MASE
## Training set 0.06109758 2.114536 1.452118 -0.01140915 2.805903 0.4053785
##                      ACF1
## Training set 0.0008242158</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="kw">plot</span>(<span class="kw">forecast</span>(fit, <span class="dv">20</span>)) </a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-24-2.png" width="672" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="co"># Una vez asjustado el modelo de series de tiempo, se obtienen y estudian los residuos:</span></a>
<a class="sourceLine" id="cb121-2" title="2"><span class="kw">lillie.test</span>(fit<span class="op">$</span>residuals) <span class="co"># No son normales</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  fit$residuals
## D = 0.10128, p-value = 3.387e-13</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">Box.test</span>(fit<span class="op">$</span>residuals) <span class="co"># Parece que Xn+1 no depende de Xn</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  fit$residuals
## X-squared = 0.00033627, df = 1, p-value = 0.9854</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">tsdiag</span>(fit, <span class="dt">gof.lag=</span><span class="dv">50</span>) <span class="co"># No hay autocorrelación</span></a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-24-3.png" width="672" /></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">qcc</span>(fit<span class="op">$</span>residuals,<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>) <span class="co"># No normales: Este gráfico no es fiable</span></a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-24-4.png" width="672" /></p>
<pre><code>## List of 11
##  $ call      : language qcc(data = fit$residuals, type = &quot;xbar.one&quot;)
##  $ type      : chr &quot;xbar.one&quot;
##  $ data.name : chr &quot;fit$residuals&quot;
##  $ data      : num [1:495, 1] 0.051 0.0465 0.0464 0.0505 0.0514 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics: Named num [1:495] 0.051 0.0465 0.0464 0.0505 0.0514 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:495] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes     : int [1:495] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center    : num 0.0611
##  $ std.dev   : num 1.79
##  $ nsigmas   : num 3
##  $ limits    : num [1, 1:2] -5.3 5.42
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations:List of 2
##  - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="co"># Se aconseja la aplicación del gráfico EWMA, pues los residuos no son normales:</span></a>
<a class="sourceLine" id="cb128-2" title="2"></a>
<a class="sourceLine" id="cb128-3" title="3">ew=<span class="kw">ewma</span>(fit<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">418</span>],<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>) </a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-24-5.png" width="672" />
Eliminamos las muestras fuera de control por deberse a picos y valles atípicos de humedad, correspondientes a condiciones especiales.</p>
<p>Se incluyen los residuos de la muestra de monitorizado::</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">ewma</span>(fit<span class="op">$</span>residuals[<span class="op">-</span><span class="kw">c</span>(ew[<span class="dv">15</span>]<span class="op">$</span>violations,<span class="dv">419</span><span class="op">:</span><span class="dv">495</span>)],<span class="dt">newdata=</span>fit<span class="op">$</span>residuals[<span class="dv">419</span><span class="op">:</span><span class="dv">495</span>],<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<pre><code>## List of 19
##  $ call        : language ewma(data = fit$residuals[-c(ew[15]$violations, 419:495)], newdata = fit$residuals[419:495],      type = &quot;xbar.one&quot;)
##  $ type        : chr &quot;ewma&quot;
##  $ data.name   : chr &quot;fit$residuals[-c(ew[15]$violations, 419:495)]&quot;
##  $ data        : num [1:411, 1] 0.051 0.0465 0.0464 0.0505 0.0514 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics  : Named num [1:411] 0.051 0.0465 0.0464 0.0505 0.0514 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:411] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes       : int [1:411] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center      : num 0.137
##  $ std.dev     : num 1.69
##  $ newstats    : Named num [1:77] -0.0601 -4.0652 0.562 -2.4572 -1.8076 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:77] &quot;412&quot; &quot;413&quot; &quot;414&quot; &quot;415&quot; ...
##  $ newdata     : num [1:77, 1] -0.0601 -4.0652 0.562 -2.4572 -1.8076 ...
##  $ newsizes    : int [1:77] 1 1 1 1 1 1 1 1 1 1 ...
##  $ newdata.name: chr &quot;fit$residuals[419:495]&quot;
##  $ x           : int [1:488] 1 2 3 4 5 6 7 8 9 10 ...
##  $ y           : Named num [1:488] 0.1199 0.1052 0.0935 0.0849 0.0782 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:488] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sigma       : num [1:488] 0.338 0.433 0.484 0.514 0.532 ...
##  $ lambda      : num 0.2
##  $ nsigmas     : num 3
##  $ limits      : num [1:488, 1:2] -0.877 -1.162 -1.315 -1.405 -1.46 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations  : Named int 417
##   ..- attr(*, &quot;names&quot;)= chr &quot;417&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;ewma.qcc&quot;</code></pre>
<p>Conclusión: una vez eliminadas las observaciones fuera de control, no aparecen más, SE SUPONE QUE LA HUMEDAD ESTA BAJO CONTROL, no se han observado fueras de control ni causa asignable.</p>
<p>NOTA: podría haberse estudiado la humedad mediante gráficos de medias. Se agrupan los datos de a dos (no tendría sentido incluir en un mismo grupo la humedad a las 9:00 y la humedad a las 12:00, pues se supone que pueden ser muy diferentes)</p>
<p><strong>Se estudia el consumo energético de las instalaciones de climatización</strong></p>
<p>¿Normalidad, autocorrelación del consumo de las instalaciones de climatización?</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">lillie.test</span>(MultivarianteOCUP[<span class="dv">1</span><span class="op">:</span><span class="dv">418</span>,<span class="dv">12</span>]) <span class="co"># No normal</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  MultivarianteOCUP[1:418, 12]
## D = 0.22047, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">Box.test</span>(MultivarianteOCUP[<span class="dv">1</span><span class="op">:</span><span class="dv">418</span>,<span class="dv">12</span>]) <span class="co"># Dependencia, Xn+1 depende de Xn</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  MultivarianteOCUP[1:418, 12]
## X-squared = 39.678, df = 1, p-value = 2.995e-10</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="co"># Estos gráficos no son fiables (dan + fuera de control que los que en realidad son):</span></a>
<a class="sourceLine" id="cb135-2" title="2"><span class="kw">qcc</span>(MultivarianteOCUP[<span class="dv">1</span><span class="op">:</span><span class="dv">418</span>,<span class="dv">12</span>],<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>) <span class="co"># Hay una cierta dependencia</span></a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre><code>## List of 11
##  $ call      : language qcc(data = MultivarianteOCUP[1:418, 12], type = &quot;xbar.one&quot;)
##  $ type      : chr &quot;xbar.one&quot;
##  $ data.name : chr &quot;MultivarianteOCUP[1:418, 12]&quot;
##  $ data      : num [1:418, 1] 1.24 3.56 1.39 0.3 0.3 3.39 8 4.4 4.3 4.24 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics: Named num [1:418] 1.24 3.56 1.39 0.3 0.3 3.39 8 4.4 4.3 4.24 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:418] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes     : int [1:418] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center    : num 1.63
##  $ std.dev   : num 1.07
##  $ nsigmas   : num 3
##  $ limits    : num [1, 1:2] -1.59 4.85
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations:List of 2
##  - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
</div>
<div id="ar1" class="section level4">
<h4><span class="header-section-number">5.1.2.3</span> Ejemplo práctico ARIMA</h4>
<p>PROCEDIMIENTO: se ajusta un modelo de series de tiempo (ARIMA) y, una vez ajustada la autocorrelación, se controlan los residuos:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">library</span>(forecast)</a>
<a class="sourceLine" id="cb137-2" title="2">myts &lt;-<span class="st"> </span><span class="kw">ts</span>(MultivarianteOCUP[,<span class="dv">12</span>], <span class="dt">start=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">frequency=</span><span class="dv">11</span>) </a>
<a class="sourceLine" id="cb137-3" title="3"><span class="kw">plot</span>(myts)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1">fit &lt;-<span class="st"> </span><span class="kw">auto.arima</span>(myts,<span class="dt">stepwise=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb138-2" title="2"></a>
<a class="sourceLine" id="cb138-3" title="3"><span class="kw">summary</span>(fit)</a></code></pre></div>
<pre><code>## Series: myts 
## ARIMA(2,1,1)(2,0,0)[11] 
## 
## Coefficients:
##          ar1     ar2      ma1    sar1    sar2
##       0.1759  0.1215  -0.9743  0.1383  0.0690
## s.e.  0.0470  0.0469   0.0142  0.0468  0.0468
## 
## sigma^2 estimated as 3.036:  log likelihood=-973.96
## AIC=1959.91   AICc=1960.08   BIC=1985.13
## 
## Training set error measures:
##                       ME     RMSE      MAE      MPE     MAPE      MASE
## Training set -0.06116899 1.731823 1.194253 -192.565 217.0451 0.9423808
##                     ACF1
## Training set 0.005098083</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1"><span class="kw">plot</span>(<span class="kw">forecast</span>(fit, <span class="dv">20</span>)) </a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="co"># Vamos con los residuos:</span></a>
<a class="sourceLine" id="cb141-2" title="2"><span class="kw">lillie.test</span>(fit<span class="op">$</span>residuals) <span class="co"># No son normales</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  fit$residuals
## D = 0.20988, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">Box.test</span>(fit<span class="op">$</span>residuals) <span class="co"># Parece que Xn+1 no depende de Xn</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  fit$residuals
## X-squared = 0.012865, df = 1, p-value = 0.9097</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"><span class="kw">tsdiag</span>(fit, <span class="dt">gof.lag=</span><span class="dv">100</span>) <span class="co"># No hay autocorrelación</span></a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-27-3.png" width="672" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"><span class="kw">qcc</span>(fit<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">418</span>],<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>) <span class="co"># No normales: Este gráfico no es fiable</span></a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-27-4.png" width="672" /></p>
<pre><code>## List of 11
##  $ call      : language qcc(data = fit$residuals[1:418], type = &quot;xbar.one&quot;)
##  $ type      : chr &quot;xbar.one&quot;
##  $ data.name : chr &quot;fit$residuals[1:418]&quot;
##  $ data      : num [1:418, 1] 0.00124 1.78266 -0.93614 -1.62227 -0.91689 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics: Named num [1:418] 0.00124 1.78266 -0.93614 -1.62227 -0.91689 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:418] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes     : int [1:418] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center    : num -0.0904
##  $ std.dev   : num 1.25
##  $ nsigmas   : num 3
##  $ limits    : num [1, 1:2] -3.84 3.66
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations:List of 2
##  - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"><span class="co"># Se aplica el gráfico EWMA, pues los resíduos no son normales:</span></a>
<a class="sourceLine" id="cb148-2" title="2"></a>
<a class="sourceLine" id="cb148-3" title="3">ew=<span class="kw">ewma</span>(fit<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">418</span>],<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>) </a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-27-5.png" width="672" /></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">ew[<span class="dv">15</span>]<span class="op">$</span>violations</a></code></pre></div>
<pre><code>##   7  16  17  81 190 203 233 235 237 238 271 343 351 356 
##   7  16  17  81 190 203 233 235 237 238 271 343 351 356</code></pre>
<p>Eliminamos los puntos fuera de control por deberse a picos y valles atípicos de consumo, correspondientes a condiciones especiales (horas punta de días especiales: reuniones, alta ocupación, encendido de ventilación…).
Se muestra la muestra de monitorizado:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1"><span class="kw">ewma</span>(fit<span class="op">$</span>residuals[<span class="op">-</span><span class="kw">c</span>(ew[<span class="dv">15</span>]<span class="op">$</span>violations,<span class="dv">419</span><span class="op">:</span><span class="dv">490</span>)],<span class="dt">newdata=</span>fit<span class="op">$</span>residuals[<span class="dv">419</span><span class="op">:</span><span class="dv">490</span>],</a>
<a class="sourceLine" id="cb151-2" title="2">     <span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<pre><code>## List of 19
##  $ call        : language ewma(data = fit$residuals[-c(ew[15]$violations, 419:490)], newdata = fit$residuals[419:490],      type = &quot;xbar.one&quot;)
##  $ type        : chr &quot;ewma&quot;
##  $ data.name   : chr &quot;fit$residuals[-c(ew[15]$violations, 419:490)]&quot;
##  $ data        : num [1:409, 1] 0.00124 1.78266 -0.93614 -1.62227 -0.91689 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics  : Named num [1:409] 0.00124 1.78266 -0.93614 -1.62227 -0.91689 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:409] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes       : int [1:409] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center      : num -0.272
##  $ std.dev     : num 1.01
##  $ newstats    : Named num [1:72] -1.071 -0.685 -0.4 6.267 -1.189 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:72] &quot;410&quot; &quot;411&quot; &quot;412&quot; &quot;413&quot; ...
##  $ newdata     : num [1:72, 1] -1.071 -0.685 -0.4 6.267 -1.189 ...
##  $ newsizes    : int [1:72] 1 1 1 1 1 1 1 1 1 1 ...
##  $ newdata.name: chr &quot;fit$residuals[419:490]&quot;
##  $ x           : int [1:481] 1 2 3 4 5 6 7 8 9 10 ...
##  $ y           : Named num [1:481] -0.2176 0.1825 -0.0412 -0.3574 -0.4693 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:481] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sigma       : num [1:481] 0.203 0.26 0.291 0.309 0.32 ...
##  $ lambda      : num 0.2
##  $ nsigmas     : num 3
##  $ limits      : num [1:481, 1:2] -0.881 -1.052 -1.144 -1.198 -1.231 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations  : Named int [1:24] 60 185 222 223 225 252 253 379 380 402 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:24] &quot;60&quot; &quot;185&quot; &quot;222&quot; &quot;223&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;ewma.qcc&quot;</code></pre>
<p>Conclusión: una vez eliminados las observaciones fuera de control, aparecen más, es decir, el sistema no está bajo control. Parece que continuamente los operarios están actuando sobre el sistema.</p>
<p>Puede ser debido a que también haya dos poblaciones. Por ejemplo, no estamos teniendo en cuenta las horas donde la instalación esta apagada (con un consumo residual sólo debido al mantenimiento del sistema informático y al encendido, &lt;=0.3 KW)</p>
<p>Utilizando todos los datos como muestra de calibrado:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1">Consumo_ON=MultivarianteOCUP<span class="op">$</span>ConsumoUE03[MultivarianteOCUP<span class="op">$</span>ConsumoUE03<span class="op">&gt;</span><span class="fl">0.3</span>]</a>
<a class="sourceLine" id="cb153-2" title="2"><span class="kw">ewma</span>(Consumo_ON,<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<pre><code>## List of 15
##  $ call      : language ewma(data = Consumo_ON, type = &quot;xbar.one&quot;)
##  $ type      : chr &quot;ewma&quot;
##  $ data.name : chr &quot;Consumo_ON&quot;
##  $ data      : num [1:277, 1] 1.24 3.56 1.39 3.39 8 4.4 4.3 4.24 4.1 1.27 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics: Named num [1:277] 1.24 3.56 1.39 3.39 8 4.4 4.3 4.24 4.1 1.27 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:277] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes     : int [1:277] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center    : num 2.73
##  $ std.dev   : num 1.39
##  $ x         : int [1:277] 1 2 3 4 5 6 7 8 9 10 ...
##  $ y         : Named num [1:277] 2.43 2.66 2.4 2.6 3.68 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:277] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sigma     : num [1:277] 0.279 0.357 0.399 0.424 0.439 ...
##  $ lambda    : num 0.2
##  $ nsigmas   : num 3
##  $ limits    : num [1:277, 1:2] 1.89 1.65 1.53 1.45 1.41 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations: Named int [1:28] 14 15 16 17 18 19 20 142 143 144 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:28] &quot;14&quot; &quot;15&quot; &quot;16&quot; &quot;17&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;ewma.qcc&quot;</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1"><span class="kw">qcc</span>(Consumo_ON,<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-29-2.png" width="672" /></p>
<pre><code>## List of 11
##  $ call      : language qcc(data = Consumo_ON, type = &quot;xbar.one&quot;)
##  $ type      : chr &quot;xbar.one&quot;
##  $ data.name : chr &quot;Consumo_ON&quot;
##  $ data      : num [1:277, 1] 1.24 3.56 1.39 3.39 8 4.4 4.3 4.24 4.1 1.27 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics: Named num [1:277] 1.24 3.56 1.39 3.39 8 4.4 4.3 4.24 4.1 1.27 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:277] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes     : int [1:277] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center    : num 2.73
##  $ std.dev   : num 1.39
##  $ nsigmas   : num 3
##  $ limits    : num [1, 1:2] -1.46 6.91
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations:List of 2
##  - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1"><span class="kw">Box.test</span>(Consumo_ON) <span class="co"># Hay autocorrelación</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  Consumo_ON
## X-squared = 15.616, df = 1, p-value = 7.761e-05</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1">myts &lt;-<span class="st"> </span><span class="kw">ts</span>(Consumo_ON, <span class="dt">start=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">frequency=</span><span class="dv">11</span>) </a>
<a class="sourceLine" id="cb159-2" title="2"><span class="kw">plot</span>(myts)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-29-3.png" width="672" /></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1">fit &lt;-<span class="st"> </span><span class="kw">auto.arima</span>(myts,<span class="dt">stepwise=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb160-2" title="2"></a>
<a class="sourceLine" id="cb160-3" title="3"><span class="kw">summary</span>(fit) <span class="co"># ARIMA(3,0,0)(1,0,0)[11]</span></a></code></pre></div>
<pre><code>## Series: myts 
## ARIMA(3,0,0)(1,0,0)[11] with non-zero mean 
## 
## Coefficients:
##          ar1     ar2     ar3     sar1    mean
##       0.2147  0.0776  0.0283  -0.0208  2.7194
## s.e.  0.0603  0.0614  0.0608   0.0620  0.1610
## 
## sigma^2 estimated as 3.527:  log likelihood=-565.13
## AIC=1142.26   AICc=1142.57   BIC=1164
## 
## Training set error measures:
##                       ME     RMSE      MAE       MPE     MAPE      MASE
## Training set 0.002245643 1.860957 1.407624 -72.65197 98.70123 0.6910303
##                      ACF1
## Training set -0.000846751</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">plot</span>(<span class="kw">forecast</span>(fit, <span class="dv">2</span>)) </a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-29-4.png" width="672" /></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1"><span class="co"># Se estudian las hipótesis sobre los residuos:</span></a>
<a class="sourceLine" id="cb163-2" title="2"><span class="kw">lillie.test</span>(fit<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]) <span class="co"># Son normales</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  fit$residuals[1:20]
## D = 0.23888, p-value = 0.004004</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1"><span class="kw">Box.test</span>(fit<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]) <span class="co"># Parece que Xn+1 no depende de Xn</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  fit$residuals[1:20]
## X-squared = 0.064604, df = 1, p-value = 0.7994</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1"><span class="kw">windows</span>()</a>
<a class="sourceLine" id="cb167-2" title="2"><span class="kw">tsdiag</span>(fit, <span class="dt">gof.lag=</span><span class="dv">7</span>) <span class="co"># No hay autocorrelación</span></a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-29-5.png" width="672" />
El consumo diario no está bajo control. Existen picos de consumo excesivos comparados con las demás observaciones.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1"><span class="kw">qcc</span>(fit<span class="op">$</span>residuals,<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<pre><code>## List of 11
##  $ call      : language qcc(data = fit$residuals, type = &quot;xbar.one&quot;)
##  $ type      : chr &quot;xbar.one&quot;
##  $ data.name : chr &quot;fit$residuals&quot;
##  $ data      : num [1:277, 1] -1.431 1.186 -1.387 0.932 5.215 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics: Named num [1:277] -1.431 1.186 -1.387 0.932 5.215 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:277] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes     : int [1:277] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center    : num 0.00225
##  $ std.dev   : num 1.58
##  $ nsigmas   : num 3
##  $ limits    : num [1, 1:2] -4.73 4.73
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations:List of 2
##  - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
<p>Otra posible causa: puede ser que no haya eliminado toda la dependencia. Por tanto, agrupanos en medidas diarias (gran inconveniente: se pierde mucha información)</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1">ConsumoDiario=<span class="kw">apply</span>(<span class="kw">matrix</span>(MultivarianteOCUP<span class="op">$</span>ConsumoUE03,<span class="dt">ncol=</span><span class="dv">11</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>),<span class="dv">1</span>,mean)</a>
<a class="sourceLine" id="cb170-2" title="2"><span class="kw">lillie.test</span>(ConsumoDiario) <span class="co"># Son normales</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  ConsumoDiario
## D = 0.078898, p-value = 0.6878</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1"><span class="kw">Box.test</span>(ConsumoDiario) <span class="co"># Hay dependencia</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  ConsumoDiario
## X-squared = 14.024, df = 1, p-value = 0.0001805</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1">myts &lt;-<span class="st"> </span><span class="kw">ts</span>(ConsumoDiario, <span class="dt">start=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">frequency=</span><span class="dv">5</span>) </a>
<a class="sourceLine" id="cb174-2" title="2"><span class="kw">plot</span>(myts)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1">fit &lt;-<span class="st"> </span><span class="kw">auto.arima</span>(myts,<span class="dt">stepwise=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb175-2" title="2"></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="kw">summary</span>(fit)</a></code></pre></div>
<pre><code>## Series: myts 
## ARIMA(0,1,2)(0,0,1)[5] 
## 
## Coefficients:
##           ma1      ma2     sma1
##       -0.2862  -0.3108  -0.3601
## s.e.   0.1508   0.1496   0.1500
## 
## sigma^2 estimated as 0.5713:  log likelihood=-49.17
## AIC=106.34   AICc=107.37   BIC=113.48
## 
## Training set error measures:
##                      ME      RMSE       MAE       MPE    MAPE      MASE
## Training set -0.1417365 0.7214492 0.5599873 -54.06407 73.7874 0.5657476
##                    ACF1
## Training set -0.0724909</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1"><span class="kw">plot</span>(<span class="kw">forecast</span>(fit, <span class="dv">2</span>)) </a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-31-2.png" width="672" /></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1"><span class="co"># Vamos con los residuos:</span></a>
<a class="sourceLine" id="cb178-2" title="2"><span class="kw">lillie.test</span>(fit<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]) <span class="co"># Son normales</span></a></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  fit$residuals[1:20]
## D = 0.13775, p-value = 0.4098</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" title="1"><span class="kw">Box.test</span>(fit<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]) <span class="co"># Parece que Xn+1 no depende de Xn</span></a></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  fit$residuals[1:20]
## X-squared = 0.52562, df = 1, p-value = 0.4685</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" title="1"><span class="kw">tsdiag</span>(fit, <span class="dt">gof.lag=</span><span class="dv">100</span>) <span class="co"># No hay autocorrelación</span></a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-31-3.png" width="672" /></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1"><span class="co"># El consumo diario está bajo control:</span></a>
<a class="sourceLine" id="cb183-2" title="2"></a>
<a class="sourceLine" id="cb183-3" title="3"><span class="kw">qcc</span>(fit<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>],<span class="dt">newdata=</span>fit<span class="op">$</span>residuals[<span class="dv">20</span><span class="op">:</span><span class="dv">45</span>],<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-31-4.png" width="672" /></p>
<pre><code>## List of 15
##  $ call        : language qcc(data = fit$residuals[1:20], type = &quot;xbar.one&quot;, newdata = fit$residuals[20:45])
##  $ type        : chr &quot;xbar.one&quot;
##  $ data.name   : chr &quot;fit$residuals[1:20]&quot;
##  $ data        : num [1:20, 1] 0.0032 1.1196 -1.672 -0.8223 -0.1184 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics  : Named num [1:20] 0.0032 1.1196 -1.672 -0.8223 -0.1184 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:20] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes       : int [1:20] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center      : num -0.264
##  $ std.dev     : num 0.778
##  $ newstats    : Named num [1:26] -0.487 0.251 0.914 -0.544 0.657 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:26] &quot;21&quot; &quot;22&quot; &quot;23&quot; &quot;24&quot; ...
##  $ newdata     : num [1:26, 1] -0.487 0.251 0.914 -0.544 0.657 ...
##  $ newsizes    : int [1:26] 1 1 1 1 1 1 1 1 1 1 ...
##  $ newdata.name: chr &quot;fit$residuals[20:45]&quot;
##  $ nsigmas     : num 3
##  $ limits      : num [1, 1:2] -2.6 2.07
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations  :List of 2
##  - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
</div>
<div id="grafico-ewma-para-datos-dependientes-dependencia-tipo-ar1." class="section level4">
<h4><span class="header-section-number">5.1.2.4</span> Gráfico EWMA para datos dependientes (dependencia tipo AR(1)).</h4>
<p>Función diseñada por Javier Rivero de Aguilar.</p>
<p>Se pretende hacer un control de la humedad relativa:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1"><span class="kw">qcc</span>(ConTempHRco2[,<span class="dv">9</span>],<span class="dt">type=</span><span class="st">&quot;xbar.one&quot;</span>)</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<pre><code>## List of 11
##  $ call      : language qcc(data = ConTempHRco2[, 9], type = &quot;xbar.one&quot;)
##  $ type      : chr &quot;xbar.one&quot;
##  $ data.name : chr &quot;ConTempHRco2[, 9]&quot;
##  $ data      : num [1:45, 1] 42.5 40.1 44.8 48 42.7 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ statistics: Named num [1:45] 42.5 40.1 44.8 48 42.7 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:45] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ sizes     : int [1:45] 1 1 1 1 1 1 1 1 1 1 ...
##  $ center    : num 49.5
##  $ std.dev   : num 3.59
##  $ nsigmas   : num 3
##  $ limits    : num [1, 1:2] 38.7 60.3
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##  $ violations:List of 2
##  - attr(*, &quot;class&quot;)= chr &quot;qcc&quot;</code></pre>
<p>Se observa que el sistema está aparentemente fuera de control. Esto puede ser debido a la existencia de autocorrelación en los datos.
Si no se tiene en cuenta la autocorrelación al estimar la variablilidad del proceso se obtiene un gran número de falsas alarmas.</p>
<p>Se crea una función llamada EWMAcorrelatedData para aplicar una modificación del gráfico EWMA para variables autocorreladas. Funciona muy bien con procesos AR(1), autorregresivos de orden uno.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1">EWMAcorrelatedData&lt;-<span class="cf">function</span>(x) { <span class="co">#x es la variable a controlar (consumo eléctrico en este caso)</span></a>
<a class="sourceLine" id="cb187-2" title="2">  <span class="co"># Valores posibles del parámetro lambda (relacionado con la &quot;memoria&quot;) del gráfico EWMA</span></a>
<a class="sourceLine" id="cb187-3" title="3">  lambda=<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.001</span>)) </a>
<a class="sourceLine" id="cb187-4" title="4">  z=<span class="kw">numeric</span>()   <span class="co"># Se inicializa el vector de las medias ponderadas exponencialmente</span></a>
<a class="sourceLine" id="cb187-5" title="5">  z[<span class="dv">1</span>]=<span class="kw">mean</span>(x)  <span class="co"># Se iguala la primera componente a la media de la variable a controlar (cosumo)</span></a>
<a class="sourceLine" id="cb187-6" title="6">  dim=<span class="kw">length</span>(x) <span class="co"># Dimensión de la variable a controlar</span></a>
<a class="sourceLine" id="cb187-7" title="7">  e=<span class="kw">numeric</span>()   <span class="co"># Diferencias entre el valor de la variable y la media ponderada para cada lamda</span></a>
<a class="sourceLine" id="cb187-8" title="8">  eop=<span class="kw">numeric</span>() <span class="co"># Diferencias entre el valor de la variable y la media ponderada para lamda OPT.</span></a>
<a class="sourceLine" id="cb187-9" title="9">  o=<span class="kw">numeric</span>()   <span class="co"># Suma de los cuadrados de las diferencias entre variable y media ponderada</span></a>
<a class="sourceLine" id="cb187-10" title="10">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(lambda)) {</a>
<a class="sourceLine" id="cb187-11" title="11">    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>(dim<span class="op">+</span><span class="dv">1</span>)){</a>
<a class="sourceLine" id="cb187-12" title="12">      <span class="co"># Cálculo de medias ponderadas para cada lambda. Se elige un parámetro de memoria (1-lambda)</span></a>
<a class="sourceLine" id="cb187-13" title="13">      z[k]=lambda[i]<span class="op">*</span>x[k<span class="dv">-1</span>]<span class="op">+</span>((<span class="dv">1</span><span class="op">-</span>lambda[i])<span class="op">*</span>z[k<span class="dv">-1</span>]) </a>
<a class="sourceLine" id="cb187-14" title="14">      e[k<span class="dv">-1</span>]=x[k<span class="dv">-1</span>]<span class="op">-</span>z[k<span class="dv">-1</span>] <span class="co"># Cálculo de las diferencias entre variable y media ponderada</span></a>
<a class="sourceLine" id="cb187-15" title="15">    }</a>
<a class="sourceLine" id="cb187-16" title="16">    o[i]=<span class="kw">sum</span>(e<span class="op">^</span><span class="dv">2</span>) <span class="co"># Cálculo de la suma de diferencias al cuadrado</span></a>
<a class="sourceLine" id="cb187-17" title="17">  }</a>
<a class="sourceLine" id="cb187-18" title="18">  <span class="co"># Se elige el lambda que produce el menor valor para las diferencias al cuadrado (o):</span></a>
<a class="sourceLine" id="cb187-19" title="19">  lambdaopt=lambda[<span class="kw">which.min</span>(o)] </a>
<a class="sourceLine" id="cb187-20" title="20">  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>(dim<span class="op">+</span><span class="dv">1</span>)){</a>
<a class="sourceLine" id="cb187-21" title="21">    <span class="co"># Cálculo de las medias ponderadas para lamda óptimo</span></a>
<a class="sourceLine" id="cb187-22" title="22">    z[k]=lambdaopt<span class="op">*</span>x[k<span class="dv">-1</span>]<span class="op">+</span>((<span class="dv">1</span><span class="op">-</span>lambdaopt)<span class="op">*</span>z[k<span class="dv">-1</span>]) </a>
<a class="sourceLine" id="cb187-23" title="23">    eop[k<span class="dv">-1</span>]=x[k<span class="dv">-1</span>]<span class="op">-</span>z[k<span class="dv">-1</span>] <span class="co"># Diferencias entre variable a controlar y medias ponderadas</span></a>
<a class="sourceLine" id="cb187-24" title="24">  }</a>
<a class="sourceLine" id="cb187-25" title="25">  <span class="co"># Se calculan los límites de control para los residuos o diferencias,</span></a>
<a class="sourceLine" id="cb187-26" title="26">  <span class="co"># asumiendo que son normales</span></a>
<a class="sourceLine" id="cb187-27" title="27">  UCL=z<span class="op">+</span><span class="dv">3</span><span class="op">*</span><span class="kw">sd</span>(eop)</a>
<a class="sourceLine" id="cb187-28" title="28">  LCL=z<span class="dv">-3</span><span class="op">*</span><span class="kw">sd</span>(eop)</a>
<a class="sourceLine" id="cb187-29" title="29">  outl=<span class="dv">0</span></a>
<a class="sourceLine" id="cb187-30" title="30">  outu=<span class="dv">0</span></a>
<a class="sourceLine" id="cb187-31" title="31">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(dim)){</a>
<a class="sourceLine" id="cb187-32" title="32">    <span class="cf">if</span> (x[i]<span class="op">&lt;</span>LCL[i]) outl=<span class="kw">c</span>(outl,i) <span class="co"># Marcador de las observaciones por debajo lím inferior</span></a>
<a class="sourceLine" id="cb187-33" title="33">  }</a>
<a class="sourceLine" id="cb187-34" title="34">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(dim)){</a>
<a class="sourceLine" id="cb187-35" title="35">    <span class="cf">if</span> (x[i]<span class="op">&gt;</span>UCL[i]) outu=<span class="kw">c</span>(outu,i) <span class="co"># Marcador de las observaciones por encima lím superior</span></a>
<a class="sourceLine" id="cb187-36" title="36">  }</a>
<a class="sourceLine" id="cb187-37" title="37">  </a>
<a class="sourceLine" id="cb187-38" title="38">  </a>
<a class="sourceLine" id="cb187-39" title="39">  <span class="co"># Salidas de la función: lambda óptimo, test de normalidad de los residuos,</span></a>
<a class="sourceLine" id="cb187-40" title="40">  <span class="co"># suma de cuadrados de los residuos para lambda óptimo, </span></a>
<a class="sourceLine" id="cb187-41" title="41">  <span class="co"># gráficos de control con valores de la variable, valores de las medias ponderadas y</span></a>
<a class="sourceLine" id="cb187-42" title="42">  <span class="co"># límites de control naturales,</span></a>
<a class="sourceLine" id="cb187-43" title="43">  <span class="co"># Valores fuera de los límites de control:</span></a>
<a class="sourceLine" id="cb187-44" title="44">  </a>
<a class="sourceLine" id="cb187-45" title="45">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">LambdaOptimo=</span>lambdaopt,<span class="dt">TestNormal=</span><span class="kw">shapiro.test</span>(eop),</a>
<a class="sourceLine" id="cb187-46" title="46">              <span class="dt">Resid=</span><span class="kw">sum</span>(eop<span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb187-47" title="47">              <span class="dt">plot=</span><span class="kw">plot</span>(x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="kw">min</span>(LCL),<span class="kw">max</span>(UCL)),<span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">main=</span><span class="st">&quot;Approximate ewma procedure for correlated data&quot;</span>)</a>
<a class="sourceLine" id="cb187-48" title="48">              ,<span class="kw">lines</span>(z,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">type=</span><span class="st">&quot;p&quot;</span>,<span class="dt">pch=</span><span class="dv">22</span>)</a>
<a class="sourceLine" id="cb187-49" title="49">              ,<span class="kw">lines</span>(UCL,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">23</span>)</a>
<a class="sourceLine" id="cb187-50" title="50">              ,<span class="kw">lines</span>(LCL,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">24</span>)</a>
<a class="sourceLine" id="cb187-51" title="51">              ,<span class="dt">outup=</span>outu</a>
<a class="sourceLine" id="cb187-52" title="52">              ,<span class="dt">outlow=</span>outl</a>
<a class="sourceLine" id="cb187-53" title="53">              ,<span class="kw">c</span>(<span class="kw">length</span>(outu)<span class="op">-</span><span class="dv">1</span>,<span class="kw">length</span>(outl)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb187-54" title="54">  ))</a>
<a class="sourceLine" id="cb187-55" title="55">}</a></code></pre></div>
<p>Se observa que el consumo estudiado en las fechas indicadas está realmente bajo control:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" title="1"><span class="kw">EWMAcorrelatedData</span>(ConTempHRco2[,<span class="dv">9</span>])</a></code></pre></div>
<p><img src="Control_book_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<pre><code>## $LambdaOptimo
## [1] 0.644
## 
## $TestNormal
## 
##  Shapiro-Wilk normality test
## 
## data:  eop
## W = 0.9862, p-value = 0.8624
## 
## 
## $Resid
## [1] 1141.021
## 
## $plot
## NULL
## 
## [[5]]
## NULL
## 
## [[6]]
## NULL
## 
## [[7]]
## NULL
## 
## $outup
## [1] 0
## 
## $outlow
## [1] 0
## 
## [[10]]
## [1] 0 0</code></pre>
</div>
</div>
<div id="autocorr" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Análisis de capacidad con datos autocorrelados.</h3>
<p>Se ensaya una versión de los índices de capacidad cuando cuando la característica crítica de calidad está autocorrelada según un proceso AR(1), autorregresivo de orden 1.</p>
<p><strong>Se ajusta un modelo AR(1) a los datos del consumo horario en horas de ocupación</strong></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" title="1"><span class="kw">library</span>(forecast)</a>
<a class="sourceLine" id="cb190-2" title="2">myts=<span class="kw">ts</span>(MultivarianteOCUP[,<span class="dv">12</span>], <span class="dt">start=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">frequency=</span><span class="dv">11</span>)</a>
<a class="sourceLine" id="cb190-3" title="3"><span class="kw">library</span>(TSA)</a></code></pre></div>
<pre><code>## Warning: package &#39;TSA&#39; was built under R version 3.6.1</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;TSA&#39;:
##   method       from    
##   fitted.Arima forecast
##   plot.Arima   forecast</code></pre>
<pre><code>## 
## Attaching package: &#39;TSA&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     spec</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     acf, arima</code></pre>
<pre><code>## The following object is masked from &#39;package:utils&#39;:
## 
##     tar</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1">fit=<span class="kw">arimax</span>(myts, <span class="dt">order=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</a></code></pre></div>
<p>Para estimar los índices de capacidad de proceso, previamente tendría que estudiarse si el proceso está bajo control.
En este caso no lo está, por lo que los índices de estimados se denominan índices de rendimiento del proceso.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" title="1"><span class="co">#--Media del proceso</span></a>
<a class="sourceLine" id="cb198-2" title="2">mu=<span class="kw">mean</span>(myts) </a>
<a class="sourceLine" id="cb198-3" title="3"></a>
<a class="sourceLine" id="cb198-4" title="4"><span class="co">#-Varianza de los residuos:</span></a>
<a class="sourceLine" id="cb198-5" title="5">sigma_a=<span class="kw">sd</span>(fit<span class="op">$</span>residuals)</a>
<a class="sourceLine" id="cb198-6" title="6"></a>
<a class="sourceLine" id="cb198-7" title="7"><span class="co">#-Parámetro del proceso autorregresivo:</span></a>
<a class="sourceLine" id="cb198-8" title="8">parametro=fit<span class="op">$</span>coef[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb198-9" title="9"></a>
<a class="sourceLine" id="cb198-10" title="10"><span class="co"># La igualdad Var(proceso)=sigma_a^2/(1-parametro^2) se dará con procesos AR(1)</span></a>
<a class="sourceLine" id="cb198-11" title="11"></a>
<a class="sourceLine" id="cb198-12" title="12"><span class="co"># Sigma_r:</span></a>
<a class="sourceLine" id="cb198-13" title="13"></a>
<a class="sourceLine" id="cb198-14" title="14">sigma_r=<span class="kw">sqrt</span>((sigma_a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>parametro<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb198-15" title="15"></a>
<a class="sourceLine" id="cb198-16" title="16"><span class="co"># Límites de especificación:</span></a>
<a class="sourceLine" id="cb198-17" title="17">USL=<span class="dv">6</span>; LSL=<span class="fl">2.2</span></a>
<a class="sourceLine" id="cb198-18" title="18"></a>
<a class="sourceLine" id="cb198-19" title="19"><span class="co">#-- 1. Índice de rendimiento calculado :</span></a>
<a class="sourceLine" id="cb198-20" title="20">C_pmr=(USL<span class="op">-</span>LSL)<span class="op">/</span>(<span class="dv">6</span><span class="op">*</span><span class="kw">sqrt</span>(sigma_r<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(mu<span class="op">-</span>T)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb198-21" title="21"></a>
<a class="sourceLine" id="cb198-22" title="22"><span class="co">#--2. Índice de rendimiento calculado :</span></a>
<a class="sourceLine" id="cb198-23" title="23">C_pkr=<span class="kw">min</span>((USL<span class="op">-</span>mu)<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span>sigma_r),(USL<span class="op">-</span>LSL)<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span>sigma_r))</a>
<a class="sourceLine" id="cb198-24" title="24"></a>
<a class="sourceLine" id="cb198-25" title="25">ResultadoD=<span class="kw">data.frame</span>(<span class="kw">c</span>(C_pmr,C_pkr))</a>
<a class="sourceLine" id="cb198-26" title="26"><span class="kw">colnames</span>(ResultadoD)=<span class="kw">c</span>(<span class="st">&quot;Índices de rendimiento datos dependientes&quot;</span>);<span class="kw">rownames</span>(ResultadoD)=<span class="kw">c</span>(<span class="st">&quot;C_pmr&quot;</span>,<span class="st">&quot;C_pkr&quot;</span>)</a>
<a class="sourceLine" id="cb198-27" title="27">ResultadoD</a></code></pre></div>
<pre><code>##       Índices de rendimiento datos dependientes
## C_pmr                                 0.3171492
## C_pkr                                 0.6695514</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1"><span class="co"># Índices de rendimiento datos dependientes</span></a>
<a class="sourceLine" id="cb200-2" title="2"><span class="co"># C_pmr                                 0.3171492</span></a>
<a class="sourceLine" id="cb200-3" title="3"><span class="co"># C_pkr                                 0.6695514</span></a>
<a class="sourceLine" id="cb200-4" title="4"></a>
<a class="sourceLine" id="cb200-5" title="5"><span class="co"># La instalación de clima no es capaz de  cumplir con las especificaciones </span></a>
<a class="sourceLine" id="cb200-6" title="6"><span class="co"># Cpkr y Cpmr &lt; 1.33</span></a></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="practica-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="practica-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Control_book.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
